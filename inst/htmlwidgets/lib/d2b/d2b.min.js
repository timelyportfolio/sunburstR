!function(t,n,e,r,a){"use strict";function o(t){return"function"==typeof t?t:function(){return t}}function i(){for(var t=arguments.length,n=Array(t),e=0;e<t;e++)n[e]=arguments[e];var r=n[0];return n.forEach(function(t){null!==r&&void 0!==r&&!1!==r||(r=t)}),r}function l(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t.label},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"start";e=o(e),r=o(r),a=o(a),t.each(function(t,o){var l=n.select(this),c=(""+e.call(this,t,o)).split(/\s+/).reverse(),d=void 0,u=[],s=[c.pop()],p=r.call(this,t,o),f=a.call(this,t,o),b=+l.attr("x"),h=+l.attr("y"),y=parseFloat(l.attr("dy"))||0;for(-1===i(l.html(),"").indexOf("tspan")&&l.text(""),d=c.pop();d;)s.join(" ").length+d.length>p&&(u.push(s),s=[]),s.push(d),d=c.pop();u.push(s);var g=l.selectAll("tspan").data(u),x=1.1*(u.length-1),m="end"===f?x:"middle"===f?x/2:0;g.merge(g.enter().append("tspan")).text(function(t){return t.join(" ")}).attr("x",b).attr("y",h).attr("dy",function(t,n){return y+1.1*n-m+"em"})})}function c(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;t.each(function(){var t=n.select(this),r=t.text().split(/\s+/).reverse(),a=void 0,o=[],i=0,l=parseFloat(t.attr("y"))||0,c=parseFloat(t.attr("dy"))||0,d=t.text(null).append("tspan").attr("x",0).attr("y",l).attr("dy",c+"em");for(a=r.pop();a;)o.push(a),d.text(o.join(" ")),d.node().getComputedTextLength()>e&&(o.pop(),d.text(o.join(" ")),o=[a],d=t.append("tspan").attr("x",0).attr("y",l).attr("dy",1.1*++i+c+"em").text(a)),a=r.pop()})}function d(t,e){function r(t){return{innerRadius:e.innerRadius()(t),outerRadius:e.outerRadius()(t),startAngle:e.startAngle()(t),endAngle:e.endAngle()(t)}}if(!t.selection)return t.attr("d",function(t){return this.current=r(t),e(t)});t.attrTween("d",function(t){var a=this;t=r(t),this.current=this.current||t;var o=n.interpolate(this.current,t);return function(t){return a.current=o(t),e(a.current)}})}function u(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return isNaN(t)||null===t?n:t}function s(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(t){return t};if(e=o(e),!t.selection)return t.text(function(t,n){return this.current=u(e.call(this,t,n)),r(this.current)});t.tween("text",function(t,a){var o=this,i=u(e.call(this,t,a));this.current=u(this.current,i);var l=n.interpolate(this.current,i);return function(t){o.textContent=r(o.current=l(t))}})}function p(t,e){function r(t){return{innerRadius:e.innerRadius()(t),outerRadius:e.outerRadius()(t),startAngle:e.startAngle()(t),endAngle:e.endAngle()(t),rotate:a(t)||0}}var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(t){return t.rotate};if(a=o(a),!t.selection)return t.attr("transform",function(t){return this.current=r(t),"translate("+e.centroid(this.current)+")rotate("+this.current.rotate+")"});t.attrTween("transform",function(t){var a=this;t=r(t),this.current=this.current||t;var o=n.interpolate(this.current,t);return function(t){return a.current=o(t),"translate("+e.centroid(a.current)+") rotate("+(a.current.rotate||0)+")"}})}function f(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments[2],i=function(n,e){return function(a){if(!arguments.length)return r[n];var o=r[n];return r[n]=a,e&&e(a,o),t}},l=function(t){return function(){return r[t]}},c=function(n,e){return function(a){if(!arguments.length)return r[n];var i=r[n];return r[n]=o(a),e&&e(r[n],i),t}},d=function(n,e){return function(a){if(!arguments.length)return r[n];var i=r[n];return a&&a.domain?r[n]=function(){return a}:r[n]=o(a),e&&e(r[n],i),t}},u={base:function(){return t},values:function(){return r},removeProp:function(n){return-1!==a.indexOf(n)?u:(r[n]=null,t[n]=null,u)},addProp:function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i(n),o=arguments[3];return r[n]||t[n]?u:(a=a||i(n,o),a(e),t[n]=a,u)},addPropGet:function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l(n);return r[n]||t[n]?u:(r[n]=e,t[n]=a,u)},addMethod:function(n,e){return t[n]?u:(t[n]=e,u)},addPropFunctor:function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c(n),o=arguments[3];return r[n]||t[n]?u:(a=a||c(n,o),a(e),t[n]=a,u)},addScaleFunctor:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:d(t),r=arguments[3];return u.addProp(t,n,e,r)},addDispatcher:function(a){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"on",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"dispatch";return t[o]?u:r[i]?u:(t[o]=function(n,e){return 0===arguments.length?r[i]:1===arguments.length?r[i].on(n):(r[i].on(n,e),t)},r[i]=n.dispatch.apply(e,a),u)}};return u}function b(){var t={},e=function t(n){var e=n.selection?n.selection():n;return e.on(l("mouseover"),a).on(l("mouseout"),i),D()?e.on(l("click"),i):e.on(l("mousemove"),o),t},r=function(e,r){var a=this.getBoundingClientRect(),o={},i=(t.at.call(this,e,r)||(n.event.clientX>window.innerWidth/2?"center left":"center right")).split(" ");switch(i={x:i[1],y:i[0]},i.x){case"left":o.x=a.left;break;case"center":o.x=a.left+a.width/2;break;default:o.x=a.left+a.width}switch(i.y){case"bottom":o.y=a.top+a.height;break;case"center":o.y=a.top+a.height/2;break;default:o.y=a.top}return o},a=function(n,e){var r=t.container.selectAll(".d2b-tooltip").data(function(t){return[t]}),a=r.enter().append("div").style("opacity",0).attr("class","d2b-tooltip");a.append("div").attr("class","d2b-tooltip-content"),r=r.merge(a),r.transition().duration(100).style("opacity",1),t.dispatch.call("insert",r,this,n,e),o.call(this,n,e)},o=function(e,a){var o=t.html.call(this,e,a),i=t.target.call(this,e,a),l=t.color.call(this,e,a),c=i?i.node():this,d=t.followMouse.call(this,e,a)?{x:n.event.clientX,y:n.event.clientY}:r.call(c,e,a),u=t.container.selectAll(".d2b-tooltip").data(function(t){return[t]}),s=t.my.call(this,e,a)||(n.event.clientX>window.innerWidth/2?"left":"right");u.attr("class","d2b-tooltip d2b-tooltip-"+s).style("top",d.y+"px").style("left",d.x+"px").style("border-color",l).select(".d2b-tooltip-content").html(o),t.dispatch.call("move",u,this,e,a)},i=function(n,e){var r=t.container.selectAll(".d2b-tooltip").data(function(t){return[t]});r.transition().duration(100).style("opacity",0).remove(),t.dispatch.call("remove",r,this,n,e)},l=function(t){return t+".d2b-tooltip"};return f(e,t).addProp("container",n.select("body")).addMethod("clear",function(t){return(t.selection?t.selection():t).on(l("mouseover"),null).on(l("mouseout"),null).on(l("mousemove"),null),e}).addPropFunctor("followMouse",!1).addPropFunctor("color",null).addPropFunctor("my",null).addPropFunctor("at",null).addPropFunctor("target",null).addPropFunctor("html",null).addDispatcher(["insert","move","remove"]),e}function h(){var t={},e={},r=function(n,e,r){if("y"===r){if(e.y===1/0)return n.style("opacity",0);n.style("opacity",1).attr("transform","translate(0, "+e.y+")").attr("y1",0).attr("y2",0).attr("x1",0).attr("x2",t.size.width)}else{if(e.x===1/0)return n.style("opacity",0);n.style("opacity",1).attr("transform","translate("+e.x+", 0)").attr("x1",0).attr("x2",0).attr("y1",0).attr("y2",t.size.height)}},a=function(e,r,a){if(e.node()){var o=e.node().getBoundingClientRect(),i=a.x,l=a.y;t.trackY?r.y>t.size.height/2?l+=r.y-10-o.height:l+=r.y+10:l=n.event.clientY-a.y>t.size.height/2?n.event.clientY-10-o.height:n.event.clientY+10,t.trackX?r.x>t.size.width/2?i+=r.x-10-o.width:i+=r.x+10:i=n.event.clientX-a.x>t.size.width/2?n.event.clientX-10-o.width:n.event.clientX+10,i+=window.pageXOffset,l+=window.pageYOffset,e.style("left",i+"px").style("top",l+"px")}},o=function(n,e){var r=t.title(e.points.map(function(t){return t.data}));n.select(".d2b-tooltip-title").style("display",r?"block":"none").html(r);var a=n.select(".d2b-tooltip-content"),o=a.selectAll(".d2b-tooltip-row").data(e.points),i=o.enter().append("div").attr("class","d2b-tooltip-row");o.exit().remove(),o=o.merge(i).html(function(t){return t.row}).style("border-left-color",function(t){return t.color||"transparent"})},l=function(e){var r={x:n.event.clientX-e.x,y:n.event.clientY-e.y},a=1/0,o=1/0,l=[];for(var c in g)if(g.hasOwnProperty(c)){var d=g[c];for(var u in d){(function(n){if(!d.hasOwnProperty(n))return"continue";var e=d[n],c=[];e.config.data.forEach(function(n,d){var u={data:n,x:i(e.config.x(n,d),t.x(n,d)),y:i(e.config.y(n,d),t.y(n,d)),color:i(e.config.color(n,d),t.color(n,d)),row:i(e.config.row(n,d),t.row(n,d))};if(t.trackX&&t.trackY){if(u.x===a&&u.y===o)return c.push(u);var s=Math.sqrt(Math.pow(a-r.x,2)+Math.pow(o-r.y,2)),p=Math.sqrt(Math.pow(u.x-r.x,2)+Math.pow(u.y-r.y,2));p<s&&p<t.threshold&&(a=u.x,o=u.y,l=[],c=[u])}else if(t.trackX){if(u.x===a)return c.push(u);var f=Math.abs(a-r.x),b=Math.abs(u.x-r.x);b<f&&b<t.threshold&&(a=u.x,l=[],c=[u])}else if(t.trackY){if(u.y===o)return c.push(u);var h=Math.abs(o-r.y),y=Math.abs(u.y-r.y);y<h&&y<t.threshold&&(o=u.y,l=[],c=[u])}}),l=l.concat(c)})(u)}}return l=l.sort(function(t,e){return n.ascending(t.x,e.x)||n.ascending(t.y,e.y)}),{x:a,y:o,points:l}},c=function(t){t.transition().duration(50).style("opacity",0).remove()},d=function(t){t.transition().duration(50).style("opacity",1)},u=function(n,r){var a=t.svgContainer.selectAll(".d2b-tooltip-marker-x").data(t.trackX?[e]:[]),o=a.enter().append("line").attr("class","d2b-tooltip-marker-x d2b-tooltip-marker"),i=t.svgContainer.selectAll(".d2b-tooltip-marker-y").data(t.trackY?[e]:[]),l=i.enter().append("line").attr("class","d2b-tooltip-marker-y d2b-tooltip-marker"),c=t.htmlContainer.selectAll(".d2b-tooltip").data([e]),u=c.enter().append("div").attr("class","d2b-tooltip d2b-tooltip-axis");u.merge(c).call(d),i.merge(l).call(d),a.merge(o).call(d),u.append("div").attr("class","d2b-tooltip-title"),u.append("div").attr("class","d2b-tooltip-content"),t.dispatch.call("insert",t.tooltip,n,r)},s=function(){t.svgContainer.selectAll(".d2b-tooltip-marker-x").data([]).exit().call(c),t.svgContainer.selectAll(".d2b-tooltip-marker-y").data([]).exit().call(c),t.htmlContainer.selectAll(".d2b-tooltip").data([]).exit().call(c)},p=function(n,e){var i=t.svgContainer.selectAll(".d2b-tooltip-base").data([n]);i=i.merge(i.enter().append("rect").attr("class","d2b-tooltip-base"));var c=i.node().getBoundingClientRect();c={x:c.left,y:c.top};var d=l(c);if(!d.points.length)return s();u(),t.svgContainer.select(".d2b-tooltip-marker-x").call(r,d,"x"),t.svgContainer.select(".d2b-tooltip-marker-y").call(r,d,"y"),t.htmlContainer.select(".d2b-tooltip").call(o,d).call(a,d,c),t.dispatch.call("move",t.tooltip,n,e)},b=function(n,e){s(),t.dispatch.call("remove",t.tooltip,n,e)},h=function(t){return t+".d2b-tooltip-axis"},y=function(t,n){n&&n.on(h("mouseout"),null).on(h("mousemove"),null),t&&t.on(h("mouseout"),b).on(h("mousemove"),p)};f(e,t).addProp("htmlContainer",n.select("body")).addProp("svgContainer",null).addProp("tracker",n.select("body"),null,y).addProp("size",{height:0,width:0}).addProp("trackX",!0).addProp("trackY",!1).addProp("threshold",1/0).addMethod("clear",function(t,n){return 0===arguments.length?g={}:1===arguments.length?delete g[t]:arguments.length>=2&&delete g[t][n],e}).addPropFunctor("title",null).addPropFunctor("x",function(t){return t.x}).addPropFunctor("y",function(t){return t.y}).addPropFunctor("color",null).addPropFunctor("row",null).addDispatcher(["move","insert","remove"]);var g={};return e.graph=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,e=g[t]=g[t]||{},r=e[n];if(!r){r=e[n]={interface:{},config:{}};f(r.interface,r.config).addProp("data",[]).addMethod("clear",function(){return r.config.data=[],r.interface}).addMethod("addPoint",function(t){return r.config.data.push(t),r.interface}).addPropFunctor("x",null).addPropFunctor("y",null).addPropFunctor("color",null).addPropFunctor("row",null)}return r.interface},e}function y(){var t={},e=function(e){var r=this,a=e;e=e.map(t.values);var o=[],i=e.map(function(n){var e={};return n.forEach(function(n,a){var i=t.x.call(r,n,a);o.push(i),e[i]=t.y.call(r,n,a)}),e});o=n.set(o).values();var l=o.reduce(function(t,n,e){return t[n]=e,t},{}),c=n.range(0,e.length),d=o.map(function(t){return i.map(function(n){return n[t]||0})});t.stack.keys(c).value(function(t,n){return t[n]||0});var u=t.stack(d);return e.forEach(function(n,e){n.forEach(function(n,a){var o=t.x.call(r,n,a),i=u[e][l[o]];t.out.call(r,n,i[0],i[1],o)})}),a};return f(e,t).addProp("stack",n.stack()).addPropFunctor("values",function(t){return t}).addPropFunctor("x",function(t){return t.x}).addPropFunctor("y",function(t){return t.y}).addProp("out",function(t,n,e){t.y0=n,t.y1=e}),e}function g(){var t={},n=function n(e){var r=e.selection?e.selection():e,a=r.selectAll(".d2b-breadcrumbs").data(function(t){return[t]}),o=a.enter().append("div").attr("class","d2b-breadcrumbs");a=a.merge(o).classed("d2b-vertical",t.vertical);var i=a.selectAll(".d2b-breadcrumb").data(t.values,t.key),l=i.exit(),c=i.enter().append("div").attr("class","d2b-breadcrumb").style("opacity",0);return c.append("div").attr("class","d2b-breadcrumb-icon"),c.append("div").attr("class","d2b-breadcrumb-content"),i=i.merge(c).order(),i.select(".d2b-breadcrumb-content").html(t.html),e!==r&&(i=i.transition(e),l=l.transition(e).style("opacity",0)),i.style("border-color",t.color).style("opacity",1).select(".d2b-breadcrumb-icon").style("background-color",t.color),l.remove(),r.dispatch("breadcrumbs-updated",{bubbles:!0}),n};return f(n,t).addPropFunctor("values",function(t){return t}).addPropFunctor("key",function(t,n){return n}).addPropFunctor("color","blue").addPropFunctor("html",function(t){return t.html}).addPropFunctor("vertical",!0),n}function x(){var t={},e=n.symbol().size(80),r=function r(a){var o=a.selection?a.selection():a,i=o.selectAll(".d2b-legend").data(function(t){return[t]}),l=i.enter().append("div").attr("class","d2b-legend");i=i.merge(l).classed("d2b-vertical",t.vertical);var c=i.selectAll(".d2b-legend-item").data(t.values,t.key),d=c.exit(),u=c.enter().append("div").attr("class","d2b-legend-item").style("opacity",0);u.append("div").attr("class","d2b-legend-icon"),u.append("div").attr("class","d2b-legend-content"),c=c.merge(u).order(),c.select(".d2b-legend-content").html(t.html),a!==o&&(c=c.transition(a),d=d.transition(a).style("opacity",0)),c.style("opacity",1).each(function(r,a){var o=n.select(this),i=t.color(r,a),l=t.empty(r,a);o.style("border-color",i);var c=t.icon(r,a),d=o.select(".d2b-legend-icon"),u=[],s=[],p=d.node().getBoundingClientRect(),f={width:p.width,height:p.height},b={x:f.width/2,y:f.height/2};"string"==typeof c?u.push(c):s.push(c);var h=d.selectAll(".d2b-legend-svg-icon").data(function(t){return[t]}),y=h.enter().append("svg");y.attr("class","d2b-legend-svg-icon").attr("width",f.width).attr("height",f.height),h=h.merge(y);var g=h.selectAll("text").data(u),x=g.enter().append("text");g.exit().remove(),x.append("tspan"),g=g.merge(x),g.style("stroke",i).style("fill",l?"white":i).attr("transform","translate("+b.x+","+1.65*b.y+")").select("tspan").text(function(t){return t});var m=h.selectAll("path").data(s);m.exit().remove(),m=m.merge(m.enter().append("path")),m.style("stroke",i).style("fill",l?"white":i).attr("d",function(t){return e.type(t)()}).attr("transform","translate("+b.x+","+b.y+")")}),i.each(function(e,a){var i=t.allowEmptied(e,a),l=n.select(this).selectAll(".d2b-legend-item"),c=function(n){l.each(function(e,r){t.setEmpty(e,r,n)})},d=function(){var n=!0;return l.each(function(e,r){t.empty(e,r)||(n=!1)}),n},u=function(e,a){t.setEmpty(e,a,!t.empty(e,a)),!i&&d()&&c(!1),o.call(r),n.select(this.parentNode).dispatch("change",{bubbles:!0})},s=function(e,a){c(!0),t.setEmpty(e,a,!1),o.call(r),n.select(this.parentNode).dispatch("change",{bubbles:!0})};l.each(function(e,r){var a=t.clickable(e,r),o=t.dblclickable(e,r);n.select(this).on("click",a?u:null).on("dblclick",o?s:null)})}),o.dispatch("legend-updated",{bubbles:!0}),d.remove()};return f(r,t).addPropFunctor("values",function(t){return t}).addPropFunctor("key",function(t,n){return n}).addPropFunctor("color",function(t){return U(t.html)}).addPropFunctor("html",function(t){return t.html}).addPropFunctor("icon","ï„‘").addPropFunctor("vertical",!1).addPropFunctor("allowEmptied",!1).addPropFunctor("clickable",!1).addPropFunctor("dblclickable",!1).addPropFunctor("empty",function(t){return t.empty}).addPropFunctor("setEmpty",function(t,n,e){return t.empty=e}),r}function m(){function t(t){var n={top:0,left:0,right:0,bottom:0};return"number"==typeof t?{top:t,left:t,right:t,bottom:t}:(["top","bottm","right","left"].forEach(function(n){t[n]&&t[n]}),n)}function e(t,n){return{width:t&&t.width>0?t.width:n.width,height:t&&t.height>0?t.height:n.height}}function r(t,n,e){e(t),e(n)}function a(t,n,e,a,o,i){var l=t.node();if(l){e.style("top","").style("left","").style("right","").style("bottom","").style("width","").style("height","");var c=void 0;"right"===a||"left"===a?(t.classed("d2b-vertical",!0),c=l.getBoundingClientRect(),r(n,e,function(t){t.style(a,o[a]+"px").style("top",o.top+"px").style("height",i.height+"px")}),o[a]+=c.width,i.width-=c.width):"top"===a||"bottom"===a?(t.classed("d2b-vertical",!1),c=l.getBoundingClientRect(),r(n,e,function(t){t.style(a,o[a]+"px").style("left",o.left+"px").style("width",i.width+"px")}),o[a]+=c.height,i.height-=c.height):t.classed("d2b-vertical",!1)}}var o={},i=function i(l){var c=l.selection?l.selection():l,d=c.selectAll(".d2b-chart-frame").data(function(t){return[t]}),u=d.enter().append("div").attr("class","d2b-chart-frame");return d=d.merge(u),c.each(function(i){var d=n.select(this).select(".d2b-chart-frame"),u=d,s=t(o.padding(i)),p=t(o.chartPadding(i)),f=e(o.size(i),this.getBoundingClientRect());r(d,u,function(t){t.style("width",f.width+"px").style("height",f.height+"px")}),f.width-=s.left+s.right,f.height-=s.top+s.bottom;var b=o.legendEnabled(i)?[i]:[],h=d.selectAll(".d2b-legend-frame").data(b),y=h.enter().append("div").attr("class","d2b-legend-frame");h.exit().remove(),y.append("div").attr("class","d2b-legend-container"),h=h.merge(y);var g=h,x=o.breadcrumbsEnabled(i)?[i]:[],m=d.selectAll(".d2b-breadcrumbs-frame").data(x),v=m.enter().append("div").attr("class","d2b-breadcrumbs-frame");m.exit().remove(),v.append("div").attr("class","d2b-breadcrumbs-container"),m=m.merge(v);var k=m,P=d.selectAll(".d2b-chart").data(function(t){return[t]}),w=P.enter().append("svg").attr("class","d2b-chart");w.append("g").attr("class","d2b-chart-container"),P=P.merge(w);var F=P;l!==c&&(u=u.transition(l),g=g.transition(l),k=k.transition(l),F=F.transition(l)),a(m,v,k,o.breadcrumbsOrient(i),s,f),a(h,y,g,o.legendOrient(i),s,f),r(w,F,function(t){t.style("left",s.left+"px").style("top",s.top+"px").style("width",f.width+"px").style("height",f.height+"px"),t.select(".d2b-chart-container").attr("transform","translate("+[p.left,p.top]+")")}),f.width-=p.left+p.right,f.height-=p.top+p.bottom,P.select(".d2b-chart-container").node().__size__=f}),c.dispatch("chart-frame-updated",{bubbles:!0}),i};return f(i,o).addPropFunctor("size",null).addPropFunctor("legendEnabled",!0).addPropFunctor("legendOrient","bottom").addPropFunctor("breadcrumbsEnabled",!1).addPropFunctor("breadcrumbsOrient","right").addPropFunctor("chartPadding",10).addPropFunctor("padding",10),i}function v(t,n){var e={};for(var r in t)"function"!=typeof t[r]&&n.indexOf(r)<0&&(e[r]=t[r]);return e}function k(t,n,e){var r=0,a=0;if(e=o(e||1),n=o(n||function(t){return t}),t.filter(function(t){return!isNaN(q(e(t)))&&!isNaN(q(n(t)))}).forEach(function(t){var o=e(t),i=n(t);r+=o,a+=i*o}),t.length&&r)return a/r}function P(t,e,r){r=o(r||1),e=o(e||function(t){return t});var a,i=[],l=t.filter(function(t){return 0!==r(t)&&!isNaN(q(r(t)))&&!isNaN(q(e(t)))}).sort(function(t,r){return n.ascending(e(t),e(r))});a=Math.round(n.sum(l,function(t){return r(t)})/2*1e12)/1e12;var c=0,d=!1;if(l.forEach(function(t){d&&(i.push(e(t)),d=!1),c+=r(t),c===a&&(i.push(e(t)),d=!0),c>a&&0===i.length&&i.push(e(t))}),t.length)return k(i)}function w(t,n,e){e=o(e||1),n=o(n||function(t){return t});var r=[],a=0,i={};return t.forEach(function(t){var o=q(n(t));isNaN(n(t))||(i[o]=i[o]||0,i[o]+=e(t),i[o]>a?(a=i[n(t)],r=[n(t)]):i[n(t)]==a&&r.push(n(t)))}),a<=1||!r.length?null:1===r.length?r[0]:r}function F(t,e){e=o(e||function(t){return t});var r=n.extent(t,e);if(t.length)return r[1]-r[0]}function _(t,e){if(e=o(e||function(t){return t}),t.length)return n.mean(n.extent(t,e))}function A(t){return t*(180/Math.PI)}function M(t){return t*(Math.PI/180)}function z(){function t(t,n){return l.empty.call(this,t,n)?0:1}function e(t,n){var e=l.size.call(this,t,n),r=l.empty.call(this,t,n);return d.size(r?e:2.5*e).call(this,t,n)}function r(t,n){var e=l.size.call(this,t,n),r=l.empty.call(this,t,n);return d.size(r?e/3:e).call(this,t,n)}function a(t,n){var e=l.size.call(this,t,n);return d.size(e).call(this,t,n)}function o(t,a){var o=l.empty.call(this,t,a);n.select(this).select("path.d2b-point-back").transition().duration(100).attr("d",e),n.select(this).select("path.d2b-point-front").transition().duration(100).style("opacity",o?.5:1).attr("d",r)}function i(t,e){var o=l.empty.call(this,t,e);n.select(this).select("path.d2b-point-back").transition().duration(100).attr("d",a),n.select(this).select("path.d2b-point-front").transition().duration(100).style("opacity",o?0:1).attr("d",r)}var l={},c=function e(c){var d=c.selection?c.selection():c,u=d.selectAll("path.d2b-point-back").data(function(t){return[t]});u.enter().append("path").attr("class","d2b-point-back").attr("d",a).style("fill-opacity",0).style("stroke",l.stroke).style("stroke-width",l.strokeWidth),c!==d&&(u=u.transition(c)),u.attr("d",a).style("stroke",l.stroke).style("stroke-width",l.strokeWidth);var s=d.selectAll("path.d2b-point-front").data(function(t){return[t]});return s.enter().append("path").attr("class","d2b-point-front").attr("d",r).style("opacity",t).style("fill",l.fill).style("stroke",l.stroke).style("stroke-width",l.strokeWidth),c!==d&&(s=s.transition(c)),s.attr("d",r).style("opacity",t).style("fill",l.fill).style("stroke",l.stroke).style("stroke-width",l.strokeWidth),d.each(function(t,e){var r=l.active.call(this,t,e);n.select(this).on("mouseover.d2b-point",r?o:null).on("mouseout.d2b-point",r?i:null)}),d.dispatch("point-updated",{bubbles:!0}),e},d=n.symbol();return f(c,l).addPropFunctor("size",150,null,function(t){return d.size(t)}).addPropFunctor("type",n.symbolCircle,null,function(t){return d.type(t)}).addPropFunctor("active",!1).addPropFunctor("empty",!1).addPropFunctor("fill","steelblue").addPropFunctor("stroke",function(t,e){return n.rgb(l.fill.call(this,t,e)).darker(.3)}).addPropFunctor("strokeWidth","1px"),c}function E(){function t(t,n,a){var o=e(t,n,a),i=r(t,n,a);return o?{startAngle:o.endAngle,endAngle:o.endAngle}:i?{startAngle:i.startAngle,endAngle:i.startAngle}:{startAngle:0,endAngle:0}}function e(t,n,e){for(var r=n.length;--t>=0;)for(var o=a.key(e[t].data,t),i=0;i<r;++i)if(a.key(n[i].data,i)===o)return n[i]}function r(t,n,e){for(var r=e.length,o=n.length;++t<r;)for(var i=a.key(e[t].data,t),l=0;l<o;++l)if(a.key(n[l].data,l)===i)return n[l]}var a={},o=function e(r){var o=r.selection?r.selection():r;a.pie.value(a.value),a.arc.startAngle(function(t){return t.startAngle}).endAngle(function(t){return t.endAngle}).padAngle(function(t){return t.padAngle});var i=o.selectAll(".d2b-pie").data(function(t){return[a.pie(a.values(t))]}),l=i.enter().append("g").attr("class","d2b-pie");return i=i.merge(l),i.each(function(e){var i=n.select(this),l=i.selectAll(".d2b-pie-arc"),c=l.data();l=l.data(e,function(t,n){return t.key=a.key(t.data,n),t.key});var u=l.enter().append("g").attr("class","d2b-pie-arc"),s=l.exit(),p=l.merge(u).order();u.append("path").attr("fill",function(t,n){return a.color.call(this,t.data,n)});var f=p.data();u.select("path").each(function(n,e){this.current=t(e,c,f)}),s.datum(function(n,e){var r=t(e,f,c);return r.data=n.data,r.innerRadius=n.innerRadius,r.outerRadius=n.outerRadius,r}),r!==o&&(s=s.transition(r),p=p.transition(r)),p.select("path").call(d,a.arc).attr("fill",function(t,n){return a.color.call(this,t.data,n)}),s.remove().select("path").call(d,a.arc)}),o.dispatch("svg-pie-updated",{bubbles:!0}),e};return f(o,a).addProp("arc",n.arc()).addProp("pie",n.pie().sort(null)).addPropFunctor("values",function(t){return t}).addPropFunctor("key",function(t){return t.label}).addPropFunctor("value",function(t){return t.value}).addPropFunctor("color",function(t){return U(t.label)}),o}function T(t){return!(t.indexOf("NaN")>-1||t.indexOf("Inifnity")>-1)}function G(t){if(null==t||"object"!=(void 0===t?"undefined":nt(t)))return t;var n=t.constructor();for(var e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}function C(){function t(t,n){var e=a.graphs(t,n).map(function(t,n){var e={data:t,index:n,align:a.align(t,n),tooltipGraph:a.tooltipGraph(t,n),shift:a.shift(t,n),stackBy:a.stackBy(t,n),key:a.key(t,n),color:a.color(t,n)};return e.values=a.values(t,n).map(function(t,n){var r={data:t,index:n,graph:e,key:a.pkey(t,n),x:a.px(t,n),y:a.py(t,n),color:a.pcolor(t,n)||e.color,annotation:a.pannotation(t,n)};return r.y1=r.y,r.y0=0,r}),e});return c.entries(e).forEach(function(t){t.values.length>1&&l(t.values)}),e}var a={},o=function e(o){var l=o.selection?o.selection():o,c=l.selectAll(".d2b-line-graphs").data(function(t){return[t]});c=c.merge(c.enter().append("g").attr("class","d2b-line-graphs"));var d=c.selectAll(".d2b-line-graph").data(function(n,e){return t(n,e)},function(t){return t.key}),u=d.enter().append("g").attr("class","d2b-line-graph d2b-graph").style("opacity",0);u.append("path").attr("class","d2b-line").style("stroke",function(t){return t.color}).attr("d",function(t){var n=this.parentNode.parentNode,e=n.__scaleX,r=n.__scaleY;return i.call(this,t,e||a.x,r||a.y)});var s=d.merge(u).order(),p=d.exit(),f=s.select(".d2b-line");if(o!==l){s=s.transition(o),p=p.transition(o),f=f.transition(o);var b=p.style("opacity",0).select(".d2b-line"),h=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=n.max(t.values,function(t){return t.x}),l=n.min(t.values,function(t){return t.x});return r.interpolatePath(this.getAttribute("d"),i.call(this,t,a.x,a.y,e),function(t){return t.x==o||t.x==l})};void 0===r.interpolatePath?(b.attr("d",function(t){return i.call(this,t,a.x,a.y)}),f.attr("d",function(t){return i.call(this,t,a.x,a.y,!0)})):(b.attrTween("d",function(t){return h.call(this,t)}),f.attrTween("d",function(t){return h.call(this,t,!0)}))}else f.attr("d",function(t){return i.call(this,t,a.x,a.y,!0)});s.style("opacity",1),s.each(function(t){var e=this.parentNode,r=n.select(this),i=t.align,c=e.__scaleX||a.x,d=e.__scaleY||a.y,u=t.values.filter(function(t){return t.annotation}),s=r.selectAll(".d2b-line-annotation-group").data(u,function(t){return t.key}),p=s.enter().append("g");p.attr("class","d2b-line-annotation-group").attr("transform",function(n){return"translate("+(c(n.x)+t.shift)+", "+d(n[i])+")"});var f=s.merge(p),b=s.exit();o!==l&&(f=f.transition(o),b=b.transition(o)),f.style("opacity",1).attr("transform",function(n){return"translate("+(a.x(n.x)+t.shift)+", "+a.y(n[i])+")"}).call(rt,a.annotation,"d2b-line-annotation"),b.attr("transform",function(n){return n=t.values.filter(function(t){return n.key===t.key})[0]||n,"translate("+(a.x(n.x)+t.shift)+", "+a.y(n[i])+")"}).style("opacity",0).remove()}),p.remove().selectAll(".d2b-line-annotation-group").attr("transform",function(t){return"translate("+(a.x(t.x)+t.graph.shift)+", "+a.y(t[t.graph.align])+")"}),f.style("stroke",function(t){return t.color});var y=a.x.copy(),g=a.y.copy();return c.each(function(){this.__scaleX=y,this.__scaleY=g}),l.dispatch("svg-line-updated",{bubbles:!0}),e},i=function(t,n,e){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=t.shift;null===o&&(o=n.bandwidth?n.bandwidth()/2:0),t.tooltipGraph&&r&&t.tooltipGraph.data(t.values).x(function(t){return n(t.x)+o}).y(function(n){return e(n[t.align])}).color(function(t){return t.color}),a.line.x(function(t){return n(t.x)+o}).y(function(n){return e(n[t.align])});var i=a.line(t.values);return T(i)?i:this.getAttribute("d")},l=y().values(function(t){return t.values}).y(function(t){return t.y}).x(function(t){return t.x}),c=n.nest().key(function(t){var n=t.stackBy;return!1!==n&&null!==n?n:V()});return f(o,a).addProp("line",n.line()).addProp("stack",l.stack(),null,function(t){return l.stack(t)}).addProp("x",n.scaleLinear()).addProp("y",n.scaleLinear()).addProp("annotation",e.annotation?e.annotation():null).addPropGet("type","line").addPropFunctor("graphs",function(t){return t}).addPropFunctor("align","y1").addPropFunctor("tooltipGraph",function(t){return t.tooltipGraph}).addPropFunctor("shift",null).addPropFunctor("stackBy",null).addPropFunctor("key",function(t){return t.label}).addPropFunctor("values",function(t){return t.values}).addPropFunctor("color",function(t){return U(t.label)}).addPropFunctor("px",function(t){return t.x}).addPropFunctor("py",function(t){return t.y}).addPropFunctor("pcolor",null).addPropFunctor("pkey",function(t,n){return n}).addPropFunctor("pannotation",function(t){return t.annotation}).addMethod("getComputedGraphs",function(n){return(n.selection?n.selection():n).data().map(function(n,e){return t(n,e)})}).addMethod("getVisiblePoints",function(t){return o.getComputedGraphs(t).map(function(t){return[].concat.apply([],t.map(function(t){return t.values.map(function(n){return{x:n.x,y:n[t.align],graph:t}})}))})[0]}),o}function R(){function t(t,n){var e=a.graphs(t,n).map(function(t,n){var e={data:t,index:n,tooltipGraph:a.tooltipGraph(t,n),shift:a.shift(t,n),stackBy:a.stackBy(t,n),key:a.key(t,n),color:a.color(t,n)};return e.values=a.values(t,n).map(function(t,n){var r={data:t,index:n,graph:e,key:a.pkey(t,n),x:a.px(t,n),y:a.py(t,n),y0:a.py0(t,n),color:a.pcolor(t,n)||e.color,annotations:a.pannotations(t,n)};return r.y1=r.y,r.y0=i(r.y0,0),r}),e});return d.entries(e).forEach(function(t){t.values.length>1&&c(t.values)}),e}var a={},o=function e(o){var i=o.selection?o.selection():o,c=i.selectAll(".d2b-area-graphs").data(function(t){return[t]});c=c.merge(c.enter().append("g").attr("class","d2b-area-graphs"));var d=c.selectAll(".d2b-area-graph").data(function(n,e){return t(n,e)},function(t){return t.key}),u=d.enter().append("g").attr("class","d2b-area-graph d2b-graph").style("opacity",0);u.append("path").attr("class","d2b-area").style("fill",function(t){return t.color}).attr("d",function(t){var n=this.parentNode.parentNode,e=n.__scaleX,r=n.__scaleY;return l.call(this,t,e||a.x,r||a.y)});var s=d.merge(u).order(),p=d.exit(),f=s.select(".d2b-area");if(o!==i){s=s.transition(o),p=p.transition(o),f=f.transition(o);var b=p.style("opacity",0).select(".d2b-area"),h=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=n.max(t.values,function(t){return t.x}),i=n.min(t.values,function(t){return t.x});return r.interpolatePath(this.getAttribute("d"),l.call(this,t,a.x,a.y,e),function(t){return t.x==o||t.x==i})};void 0===r.interpolatePath?(b.attr("d",function(t){return l.call(this,t,a.x,a.y)}),f.attr("d",function(t){return l.call(this,t,a.x,a.y,!0)})):(b.attrTween("d",function(t){return h.call(this,t)}),f.attrTween("d",function(t){return h.call(this,t,!0)}))}else f.attr("d",function(t){return l.call(this,t,a.x,a.y,!0)});s.style("opacity",1),s.each(function(t){var e=this.parentNode,r=n.select(this),l=e.__scaleX||a.x,c=e.__scaleY||a.y;["y0","y1"].forEach(function(n){var e=t.values.filter(function(t){return(t.annotations||[]).filter(function(t){return t.location===n}).length
}),d=r.selectAll(".d2b-area-annotation-group-"+n).data(e,function(t){return t.key}),u=d.enter().append("g");u.attr("class","d2b-area-annotation-group-"+n).attr("transform",function(e){return"translate("+(l(e.x)+t.shift)+", "+c(e[n])+")"});var s=d.merge(u),p=d.exit();o!==i&&(s=s.transition(o),p=p.transition(o)),s.style("opacity",1).attr("transform",function(e){return"translate("+(a.x(e.x)+t.shift)+", "+a.y(e[n])+")"}).call(rt,a.annotation,"d2b-area-annotation",function(t){return t.annotations.filter(function(t){return t.location===n})}),p.attr("transform",function(e){return e=t.values.filter(function(t){return e.key===t.key})[0]||e,"translate("+(a.x(e.x)+t.shift)+", "+a.y(e[n])+")"}).style("opacity",0).remove()})}),p.remove(),p.selectAll(".d2b-area-annotation-group-y0").attr("transform",function(t){return"translate("+(a.x(t.x)+t.graph.shift)+", "+a.y(t.y0)+")"}),p.selectAll(".d2b-area-annotation-group-y1").attr("transform",function(t){return"translate("+(a.x(t.x)+t.graph.shift)+", "+a.y(t.y1)+")"}),f.style("fill",function(t){return t.color});var y=a.x.copy(),g=a.y.copy();return c.each(function(){this.__scaleX=y,this.__scaleY=g}),i.dispatch("svg-area-updated",{bubbles:!0}),e},l=function(t,n,e){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=t.shift;null===o&&(o=n.bandwidth?n.bandwidth()/2:0),t.tooltipGraph&&r&&t.tooltipGraph.data(t.values).x(function(t){return n(t.x)+o}).y(function(t){return e(t.y1)}).color(function(t){return t.color}),a.area.x(function(t){return n(t.x)+o}).y0(function(t){return e(t.y0)}).y1(function(t){return e(t.y1)});var i=a.area(t.values);return T(i)?i:this.getAttribute("d")},c=y().values(function(t){return t.values}).y(function(t){return t.y}).x(function(t){return t.x}),d=n.nest().key(function(t){var n=t.stackBy;return!1!==n&&null!==n?n:V()});return f(o,a).addProp("area",n.area()).addProp("stack",c.stack(),null,function(t){return c.stack(t)}).addProp("x",n.scaleLinear()).addProp("y",n.scaleLinear()).addProp("annotation",e.annotation?e.annotation():null).addPropGet("type","area").addPropFunctor("graphs",function(t){return t}).addPropFunctor("tooltipGraph",function(t){return t.tooltipGraph}).addPropFunctor("shift",null).addPropFunctor("stackBy",null).addPropFunctor("key",function(t){return t.label}).addPropFunctor("values",function(t){return t.values}).addPropFunctor("color",function(t){return U(t.label)}).addPropFunctor("px",function(t){return t.x}).addPropFunctor("py",function(t){return t.y}).addPropFunctor("py0",function(t){return t.y0}).addPropFunctor("pcolor",null).addPropFunctor("pkey",function(t,n){return n}).addPropFunctor("pannotations",function(t){return t.annotations}).addMethod("getComputedGraphs",function(n){return(n.selection?n.selection():n).data().map(function(n,e){return t(n,e)})}).addMethod("getVisiblePoints",function(t){return o.getComputedGraphs(t).map(function(t){var n=[].concat.apply([],t.map(function(t){return t.values.map(function(n){return{x:n.x,y:n.y0,graph:t}})})),e=[].concat.apply([],t.map(function(t){return t.values.map(function(n){return{x:n.x,y:n.y1,graph:t}})}));return n.concat(e)})[0]}),o}function B(){function t(t,n){var e=a.graphs(t,n).map(function(t,n){var e={data:t,index:n,align:a.align(t,n),tooltipGraph:a.tooltipGraph(t,n),shift:a.shift(t,n),stackBy:a.stackBy(t,n),key:a.key(t,n),color:a.color(t,n),symbol:a.symbol(t,n)};return e.values=a.values(t,n).map(function(t,n){var r={data:t,index:n,graph:e,x:a.px(t,n),y:a.py(t,n),color:a.pcolor(t,n)||e.color,symbol:a.psymbol(t,n)||e.symbol,key:a.pkey(t,n),size:a.psize(t,n),annotation:a.pannotation(t,n)};return r.y1=r.y,r.y0=0,r}),e});return l.entries(e).forEach(function(t){t.values.length>1&&i(t.values)}),e}function r(t,n,e,r,a){t.attr("transform",function(t){var o=e(t[a]),i=n(t.x)+r;return isFinite(i)&&isFinite(o)?"translate("+[i,o]+")":this.getAttribute("transform")})}var a={},o=function e(o){var i=o.selection?o.selection():o,l=i.selectAll(".d2b-scatter-graphs").data(function(t){return[t]});l=l.merge(l.enter().append("g").attr("class","d2b-scatter-graphs"));var c=l.selectAll(".d2b-scatter-graph").data(function(n,e){return t(n,e)},function(t){return t.key}),d=c.enter().append("g").attr("class","d2b-scatter-graph d2b-graph").style("opacity",0),u=c.merge(d).order(),s=c.exit();return o!==i&&(u=u.transition(o),s=s.transition(o),s.style("opacity",0).each(function(t){var e=n.select(this),l=a.x,c=a.y,d=e.selectAll(".d2b-scatter-point");o!==i&&(d=d.transition(o));var u=t.shift;null===u&&(u=l.bandwidth?l.bandwidth()/2:0),d.style("opacity",0).call(r,l,c,u,t.align).remove()})),u.style("opacity",1),s.remove(),u.each(function(t){var e=n.select(this),l=a.x,c=a.y,d=this.parentNode,u=d.__scaleX||l,s=d.__scaleY||c,p=t.shift;null===p&&(p=l.bandwidth?l.bandwidth()/2:0);var f=p;null===f&&(p=u.bandwidth?u.bandwidth()/2:0),t.tooltipGraph&&t.tooltipGraph.data(t.values).x(function(t){return l(t.x)+p}).y(function(t){return c(t.y)}).color(function(t){return t.color}),a.point.fill(function(t){return t.color}).type(function(t){return t.symbol}).size(function(t){return t.size});var b=e.selectAll(".d2b-scatter-point").data(t.values,function(t){return t.key}),h=b.enter().append("g").attr("class","d2b-scatter-point"),y=b.merge(h).order(),g=b.exit();o!==i&&(y=y.transition(o),g=g.transition(o)),u.bandwidth||s.bandwidth||l.bandwidth||c.bandwidth?h.call(r,l,c,p,t.align):h.call(r,u,s,f,t.align),h.style("opacity",0),y.style("opacity",1).call(a.point).call(r,l,c,p,t.align),g.style("opacity",0).call(r,l,c,p,t.align).remove(),rt(y,a.annotation,"d2b-scatter-annotation")}),l.each(function(){this.__scaleX=a.x.copy(),this.__scaleY=a.y.copy()}),i.dispatch("svg-scatter-updated",{bubbles:!0}),e},i=y().values(function(t){return t.values}).y(function(t){return t.y}).x(function(t){return t.x}),l=n.nest().key(function(t){var n=t.stackBy;return!1!==n&&null!==n?n:V()});return f(o,a).addProp("point",z().active(!0)).addProp("stack",i.stack(),null,function(t){return i.stack(t)}).addProp("x",n.scaleLinear()).addProp("y",n.scaleLinear()).addProp("annotation",e.annotation?e.annotation():null).addPropGet("type","scatter").addPropFunctor("graphs",function(t){return t}).addPropFunctor("align","y1").addPropFunctor("tooltipGraph",function(t){return t.tooltipGraph}).addPropFunctor("shift",null).addPropFunctor("stackBy",null).addPropFunctor("key",function(t){return t.label}).addPropFunctor("values",function(t){return t.values}).addPropFunctor("color",function(t){return U(t.label)}).addPropFunctor("symbol",function(){return n.symbolCircle}).addPropFunctor("px",function(t){return t.x}).addPropFunctor("py",function(t){return t.y}).addPropFunctor("pcolor",null).addPropFunctor("psymbol",null).addPropFunctor("pkey",function(t,n){return n}).addPropFunctor("psize",25).addPropFunctor("pannotation",function(t){return t.annotation}).addMethod("getComputedGraphs",function(n){return(n.selection?n.selection():n).data().map(function(n,e){return t(n,e)})}).addMethod("getVisiblePoints",function(t){return o.getComputedGraphs(t).map(function(t){return[].concat.apply([],t.map(function(t){return t.values.map(function(n){return{x:n.x,y:n[t.align],graph:t}})}))})[0]}),o}function X(){function t(t){return"horizontal"===t?{rotate:!0,px:"py",py:"px",x:"y",y:"x",w:"height",h:"width"}:{rotate:!1,px:"px",py:"py",x:"x",y:"y",w:"width",h:"height"}}function r(n,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t(b.orient(n,e)),o=b.graphs(n,e).map(function(t,n){var e={data:t,index:n,tooltipGraph:b.tooltipGraph(t,n),shift:b.shift(t,n),stackBy:b.stackBy(t,n),key:b.key(t,n),color:b.color(t,n)};return e.values=b.values(t,n).map(function(t,n){return{data:t,index:n,graph:e,key:b.pkey(t,n),x:b.px(t,n),y:b.py(t,n),centered:b.pcentered(t,n),color:b.pcolor(t,n)||e.color,annotation:b.pannotation(t,n)}}),e});return g.x(function(t){return t[r.x]}).y(function(t){return t[r.y]}),x.entries(o).forEach(function(t,n){return g.out(a(n))(t.values)}),p(o,b.baseline(n,e)),o}function a(t){var n={};return function(e,r,a,o){var i=n[o]=n[o]||[0,0];e.dy=a-r,e.stackIndex=t,e.base=o,e.dy>0?e.extent=[i[0],i[0]+=e.dy]:e.extent=[i[1],i[1]+=e.dy]}}function o(t,n){t.style("opacity",n.opacity).call(l,n).select("rect").attr("fill",function(t){return t.color}).attr(n.orientMap.w,n.width).attr(n.orientMap.h,n.height),t.select(".d2b-bar-annotation-group").call(c,n).call(rt,b.annotation,"d2b-bar-annotation")}function l(t,n){t.attr("transform",function(t){return"translate("+[n[n.orientMap.x](t),n[n.orientMap.y](t)]+")"})}function c(t,n){t.attr("transform",function(t){var e={x:n.width/2,y:t.extent[0]<t.extent[1]?0:n.height(t)};return"translate("+[e[n.orientMap.x],e[n.orientMap.y]]+")"})}function d(t,n,e,r){return function(a,o){var i=a.centered?o-n/4:o-n/2+a.stackIndex*e+r;return t(a.base)+i}}function u(t){var e=function(n){return[t(n.extent[0]),t(n.extent[1])]};return e.sorted=function(t){return e(t).slice().sort(n.ascending)},e}function s(t,e,r){var a=[],o=1/0;e.forEach(function(n){var e=n.values,i=t.range();o=Math.min(o,Math.abs(i[1]-i[0])),e.forEach(function(n){a.push(t(n[r.x]))})}),a.sort(n.ascending);for(var i=0;i<a.length-1;i++)a[i+1]!==a[i]&&(o=Math.min(a[i+1]-a[i],o));return o===1/0?0:o}function p(t,e){if(null===e){var r=[].concat.apply([],t.map(function(t){return t.values})),a=n.extent(r.map(function(t){return t.extent[1]}));e=a[1]<0?a[1]:a[0]>0?a[0]:0}t.forEach(function(t){t.values.forEach(function(t){Math.abs(t.extent[0])<Math.abs(e)&&(t.extent[0]=e)})})}var b={},h=function e(a){var l=a.selection?a.selection():a,c={x:b.x,y:b.y};return l.each(function(e,p){var f=b.orient(e,p),h=t(f),y=r(e,p,h),g=c[h.x].copy(),m=c[h.y].copy(),v=b.padding(e,p),k=b.groupPadding(e,p),P=b.bandwidth(e,p);P=(1-v)*i(P||s(g,y,h));var w=x.entries(y),F=P/Math.max(1,w.length);k*=F;var _=d(g,P,F,k),A=u(m);F-=2*k;var M=n.select(this).selectAll(".d2b-bar-graphs").data(function(t){return[t]});M=M.merge(M.enter().append("g").attr("class","d2b-bar-graphs"));var z=M.node(),E=z.__scaleBase||_,T=z.__scaleY||m,G=z.__scaleX||g,C=z.__barWidth||F,R=M.selectAll(".d2b-bar-graph").data(y.slice().reverse(),function(t){return t.key}),B=R.enter().append("g").attr("class","d2b-bar-graph d2b-graph"),X=R.merge(B).order(),Y=R.exit();a!==l&&(X=X.transition(a),Y=Y.transition(a),Y.each(function(t){var e=t.shift;null===e&&(e=g.bandwidth?g.bandwidth()/2:0);var r=n.select(this).selectAll(".d2b-bar-group").transition(a);G.bandwidth||T.bandwidth||g.bandwidth||m.bandwidth?r.style("opacity",0):r.call(o,{opacity:0,x:function(t){return _(t,e)},y:function(){return m(0)},width:F,height:function(){return 0},graph:t,orientMap:h})})),Y.remove(),X.each(function(t){var e=n.select(this),r=t.shift;null===r&&(r=g.bandwidth?g.bandwidth()/2:0);var i=e.selectAll(".d2b-bar-group").data(t.values,function(t){return t.key}),c=i.enter().append("g").attr("class","d2b-bar-group");c.append("rect"),c.append("g").attr("class","d2b-bar-annotation-group");var d=i.merge(c).order(),u=i.exit();t.tooltipGraph&&t.tooltipGraph.data(t.values)[h.x](function(t){return g(t.base)+r})[h.y](function(t){return A(t)[1]}).color(function(t){return t.color}),a!==l&&(d=d.transition(a),u=u.transition(a)),c.attr("class","d2b-bar-group"),u.remove(),G.bandwidth||T.bandwidth||g.bandwidth||m.bandwidth?(c.call(o,{opacity:0,x:function(t){return _(t,r)},y:function(){return m(0)},width:C,height:function(){return 0},graph:t,orientMap:h}),u.style("opacity",0)):(c.call(o,{opacity:0,x:function(t){return E(t,r)},y:function(){return T(0)},width:C,height:function(){return 0},graph:t,orientMap:h}),u.call(o,{opacity:0,x:function(t){return _(t,r)},y:function(){return m(0)},width:F,height:function(){return 0},graph:t,orientMap:h})),d.call(o,{opacity:1,x:function(t){return _(t,r)},y:function(t){return A.sorted(t)[0]},width:F,height:function(t){return A.sorted(t)[1]-A.sorted(t)[0]},graph:t,orientMap:h})}),z.__scaleY=m,z.__scaleX=g,z.__scaleBase=_,z.__barWidth=F}),l.dispatch("svg-bar-updated",{bubbles:!0}),e},g=y().values(function(t){return t.values}),x=n.nest().key(function(t){return t.stackBy});return f(h,b).addProp("x",n.scaleLinear()).addProp("y",n.scaleLinear()).addProp("annotation",e.annotation?e.annotation():null).addPropGet("type","bar").addPropFunctor("graphs",function(t){return t}).addPropFunctor("padding",.5).addPropFunctor("groupPadding",0).addPropFunctor("bandwidth",null).addPropFunctor("baseline",0).addPropFunctor("tooltipGraph",function(t){return t.tooltipGraph}).addPropFunctor("orient","vertical").addPropFunctor("shift",null).addPropFunctor("stackBy",function(t,n){return n}).addPropFunctor("key",function(t){return t.label}).addPropFunctor("values",function(t){return t.values},null).addPropFunctor("color",function(t){return U(t.label)}).addPropFunctor("px",function(t){return t.x}).addPropFunctor("py",function(t){return t.y}).addPropFunctor("pcentered",!1).addPropFunctor("pcolor",null).addPropFunctor("pkey",function(t,n){return n}).addPropFunctor("pannotation",function(t){return t.annotation}).addMethod("getComputedGraphs",function(t){return(t.selection?t.selection():t).data().map(function(t,n){return r(t,n)})}).addMethod("getVisiblePoints",function(n){return(n.selection?n.selection():n).data().map(function(n,e){var a=b.orient(n,e),o=t(a),i=r(n,e,o),l=[].concat.apply([],i.map(function(t){return t.values.map(function(n){var e={};return e[""+o.x]=n.base,e[""+o.y]=n.extent[0],e.graph=t,e})})),c=[].concat.apply([],i.map(function(t){return t.values.map(function(n){var e={};return e[""+o.x]=n.base,e[""+o.y]=n.extent[1],e.graph=t,e})}));return l.concat(c)})[0]}),h}function Y(){var t={},r=function n(e){var r=e.selection?e.selection():e,a=t.scale,o=t.enterScale||a,i=t.valueFormat,l="vertical"===t.orient,c=l?{x:"x",y:"y",x1:"x1",x2:"x2",y1:"y1",y2:"y2",width:"width",height:"height",cx:"cx",cy:"cy",translate:function(t,n){return"translate("+t+", "+n+")"}}:{x:"y",y:"x",x1:"y1",x2:"y2",y1:"x1",y2:"x2",width:"height",height:"width",cx:"cy",cy:"cx",translate:function(t,n){return"translate("+n+", "+t+")"}},d=r.selectAll(".d2b-box").data(function(n,e){n=t.data(n,e);var r=t.outliers(n,e)||[],a=t.minimum(n,e),o=t.maximum(n,e);return[{data:n,index:e,median:t.median(n,e),upperQuartile:t.upperQuartile(n,e),lowerQuartile:t.lowerQuartile(n,e),minimum:a,maximum:o,outliers:r,maxOutliers:r.filter(function(t){return t>o}),minOutliers:r.filter(function(t){return t<a}),color:t.color(n,e),width:t.width(n,e),annotations:t.annotations(n,e)}]}),u=d.enter().append("g").attr("class","d2b-box"),s=d.merge(u).order(),p=s.selectAll(".d2b-box-center").data(function(t){return[t]}),f=p.enter().append("line").attr(c.x1,0).attr(c.x2,0).attr(c.y1,function(t){return o(t.minimum)}).attr(c.y2,function(t){return o(t.maximum)}).attr("class","d2b-box-center"),b=p.merge(f),h=s.selectAll(".d2b-box-rect").data(function(t){return[t]}),y=h.enter().append("rect").attr("class","d2b-box-rect").attr(c.width,function(t){return t.width}).attr(c.height,function(t){return Math.abs(o(t.upperQuartile)-o(t.lowerQuartile))}).attr(c.x,function(t){return-t.width/2}).attr(c.y,function(t){return Math.min(o(t.upperQuartile),o(t.lowerQuartile))}),g=h.merge(y);return["max","min"].forEach(function(t){var n=s.selectAll(".d2b-box-"+t+"-outlier").data(function(n){return n[t+"Outliers"].map(function(t){return{outlier:t,box:n}})}),i=n.enter().append("circle").style("opacity",0).attr("r",function(t){return t.box.width/5}).attr(c.cx,0).attr(c.cy,function(t){return o(t.outlier)}).attr("class","d2b-box-outlier d2b-box-"+t+"-outlier"),l=n.merge(i),d=n.exit();e!==r&&(l=l.transition(e),d=d.transition(e)),l.style("opacity",1).attr("stroke",function(t){return t.box.color}).attr("r",function(t){return t.box.width/5}).attr(c.cx,0).attr(c.cy,function(t){return a(t.outlier)}),d.attr(c.cx,0).attr(c.cy,function(t){return a(t.outlier)}).style("opacity",0).remove()}),["maximum","median","minimum"].forEach(function(t){var n=s.selectAll(".d2b-box-dash-"+t).data(function(t){return[t]}),i=n.enter().append("line").attr("class","d2b-box-dash d2b-box-dash-"+t).attr(c.x1,function(t){return-t.width/2}).attr(c.x2,function(t){return t.width/2}).attr(c.y1,function(n){return o(n[t])}).attr(c.y2,function(n){return o(n[t])}),l=n.merge(i);e!==r&&(l=l.transition(e)),l.attr("stroke",function(t){return t.color}).attr(c.x1,function(t){return-t.width/2}).attr(c.x2,function(t){return t.width/2}).attr(c.y1,function(n){return a(n[t])}).attr(c.y2,function(n){return a(n[t])})}),["maximum","upperQuartile","median","lowerQuartile","minimum"].forEach(function(n,d){var u=s.selectAll(".d2b-box-label-group-"+n).data(function(t){return[t]}),p=u.enter().append("g").attr("class","d2b-box-label-group d2b-box-label-group-"+n).attr("transform",function(t){return c.translate(0,o(t[n]))});p.append("text").attr("class","d2b-box-label").attr(c.x,function(t){return(3+t.width/2)*(d%2==0?1:-1)}).style("text-anchor",d%2==0?"start":"end");var f=u.merge(p);e!==r&&(f=f.transition(e)),f.attr("transform",function(t){return c.translate(0,a(t[n]))}).call(rt,t.annotation,"d2b-box-annotation",function(t){return(t.annotations||[]).filter(function(t){return t.location===n})});var b=f.select(".d2b-box-label").text(function(t){return i(t[n])});l?b.select().style("text-anchor",d%2==0?"start":"end").style("dominant-baseline","middle").attr(c.x,function(t){return(3+t.width/2)*(d%2==0?1:-1)}):b.style("text-anchor","middle").style("dominant-baseline",d%2==0?"baseline":"hanging").attr(c.x,function(t){return(3+t.width/2)*(d%2==0?-1:1)})}),e!==r&&(g=g.transition(e),b=b.transition(e)),g.attr(c.x,function(t){return-t.width/2}).attr(c.y,function(t){return Math.min(a(t.upperQuartile),a(t.lowerQuartile))}).attr(c.width,function(t){return t.width}).attr(c.height,function(t){return Math.abs(a(t.upperQuartile)-a(t.lowerQuartile))}).attr("stroke",function(t){return t.color}),b.attr(c.x1,0).attr(c.x2,0).attr(c.y1,function(t){return a(t.minimum)}).attr(c.y2,function(t){return a(t.maximum)}).attr("stroke",function(t){return t.color}),r.dispatch("box-updated",{bubbles:!0}),n};return f(r,t).addProp("scale",n.scaleLinear()).addProp("enterScale",null).addProp("valueFormat",n.format(",")).addProp("orient","vertical").addProp("annotation",e.annotation?e.annotation():null).addPropFunctor("data",function(t){return t}).addPropFunctor("median",function(t){return t.median}).addPropFunctor("upperQuartile",function(t){return t.upperQuartile}).addPropFunctor("lowerQuartile",function(t){return t.lowerQuartile}).addPropFunctor("minimum",function(t){return t.minimum}).addPropFunctor("maximum",function(t){return t.maximum}).addPropFunctor("outliers",function(t){return t.outliers}).addPropFunctor("width",20).addPropFunctor("color","steelblue").addPropFunctor("annotations",function(t){return t.annotations}),r}function O(){function t(t,n){return a.graphs(t,n).map(function(t,n){var e={data:t,index:n,tooltipGraph:a.tooltipGraph(t,n),shift:a.shift(t,n),key:a.key(t,n),color:a.color(t,n),orient:a.orient(t,n)};return e.values=a.values(t,n).map(function(t,n){return{data:t,index:n,graph:e,x:a.px(t,n),y:a.py(t,n),annotations:a.pannotations(t,n),median:a.box.median()(t,n)}}),e})}function r(t,n){return"translate("+(n?[t,0]:[0,t])+")"}var a={},o=function e(o){var i=o.selection?o.selection():o,l=i.selectAll(".d2b-box-plot-graphs").data(function(t){return[t]});l=l.merge(l.enter().append("g").attr("class","d2b-box-plot-graphs"));var c=l.selectAll(".d2b-box-plot-graph").data(function(n,e){return t(n,e)},function(t){return t.key}),d=c.enter().append("g").attr("class","d2b-box-plot-graph d2b-graph").style("opacity",0),u=c.merge(d).order(),s=c.exit();return a.box.data(function(t){return t.data}).annotation(a.annotation).annotations(a.pannotations),o!==i&&(u=u.transition(o),s=s.transition(o),s.style("opacity",0).each(function(t){var e=n.select(this),l="vertical"===t.orient,c=l?{x:"x",y:"y"}:{x:"y",y:"x"},d=a[c.x],u=a[c.y];a.box.scale(u).orient(t.orient).color(function(n,e){return a.pcolor(n,e)||t.color});var s=e.selectAll(".d2b-box-plot-box");o!==i&&(s=s.transition(o));var p=t.shift;null===p&&(p=d.bandwidth?d.bandwidth()/2:0),s.style("opacity",0).attr("transform",function(t){return r(d(t[c.x])+p,l)}).call(a.box).remove()})),u.style("opacity",1),s.remove(),u.each(function(t){var e=n.select(this),l="vertical"===t.orient,c=l?{x:"x",y:"y"}:{x:"y",y:"x"},d=a[c.x],u=a[c.y],s=this.parentNode,p={x:s.__scaleX||d,y:s.__scaleY||u},f=p[c.x],b=p[c.y],h=t.shift;null===h&&(h=d.bandwidth?d.bandwidth()/2:0),null===h&&(h=f.bandwidth?f.bandwidth()/2:0),t.tooltipGraph&&t.tooltipGraph.data(t.values)[c.x](function(t){return d(t[c.x])+h})[c.y](function(t){return u(t.median)}).color(function(n,e){return a.pcolor(n.data,e)||t.color}),a.box.scale(u).enterScale(b).orient(t.orient).color(function(n,e){return a.pcolor(n,e)||t.color});var y=e.selectAll(".d2b-box-plot-box").data(t.values,a.pkey),g=y.enter().append("g").attr("class","d2b-box-plot-box"),x=y.merge(g).order(),m=y.exit();o!==i&&(x=x.transition(o),m=m.transition(o)),f.bandwidth||b.bandwidth||d.bandwidth||u.bandwidth?(a.box.enterScale(u),g.attr("transform",function(t){return r(d(t[c.x])+h,l)})):(a.box.enterScale(b),g.attr("transform",function(t){return r(f(t[c.x])+h,l)})),g.style("opacity",0),x.attr("transform",function(t){return r(d(t[c.x])+h,l)}).style("opacity",1).call(a.box),m.attr("transform",function(t){return r(d(t[c.x])+h,l)}).style("opacity",0).call(a.box).remove()}),l.each(function(){this.__scaleX=a.x.copy(),this.__scaleY=a.y.copy()}),i.dispatch("svg-box-updated",{bubbles:!0}),e};return f(o,a).addProp("x",n.scaleLinear()).addProp("y",n.scaleLinear()).addProp("box",Y()).addProp("annotation",e.annotation?e.annotation():null).addPropGet("type","boxPlot").addPropFunctor("graphs",function(t){return t}).addPropFunctor("tooltipGraph",function(t){return t.tooltipGraph}).addPropFunctor("shift",null).addPropFunctor("key",function(t){return t.label}).addPropFunctor("values",function(t){return t.values}).addPropFunctor("color",function(t){return U(t.label)}).addPropFunctor("orient","vertical").addPropFunctor("px",function(t){return t.x}).addPropFunctor("py",function(t){return t.y}).addPropFunctor("pcolor",null).addPropFunctor("pkey",function(t,n){return n}).addPropFunctor("pannotations",function(t){return t.annotations}).addMethod("getComputedGraphs",function(n){return(n.selection?n.selection():n).data().map(function(n,e){return t(n,e)})}).addMethod("getVisiblePoints",function(t){var n=o.getComputedGraphs(t),e=[];return n.forEach(function(t){t.forEach(function(t){t.values.forEach(function(n,r){["maximum","minimum","upperQuartile","lowerQuartile","median"].forEach(function(o){e.push({x:n.x,y:a.box[o]()(n.data,r),graph:t})}),(a.box.outliers()(n.data,r)||[]).forEach(function(r){e.push({x:n.x,y:r,graph:t})})})})}),e}),o}function L(){function t(n,e,r){return{data:n,index:e,graph:r,x:p.px(n,e),y:p.py(n,e),color:p.pcolor(n,e)||r.color,symbol:p.psymbol(n,e)||r.symbol,key:p.pkey(n,e),size:p.psize(n,e),indicator:p.pindicator(n,e),annotation:p.pannotation(n,e),children:(p.pchildren(n,e)||[]).map(function(n,e){return t(n,e,r)})}}function r(n,e){var r=p.graphs(n,e).map(function(n,e){var r={data:n,index:e,tendancy:p.tendancy(n,e),tooltipGraph:p.tooltipGraph(n,e),shift:p.shift(n,e),key:p.key(n,e),color:p.color(n,e),symbol:p.symbol(n,e)};return r.values=p.values(n,e).map(function(n,e){return t(n,e,r)}),r});return r.forEach(function(t){return t.values.forEach(function(n){return s(n,t.tendancy)})}),r}function a(t,n){t.data.expanded=n,t.children.forEach(function(t){return a(t,n)})}function l(t,n){var e=5,r=5;t.selectAll(".d2b-bubble-indicator.d2b-active").attr("transform",function(){var t=this.getBBox();t.width+e>n&&e>0&&(e=5,r+=t.height+5);var a="translate("+e+", "+r+")";return e+=t.width+5,a})}function c(t,e,r,a,o){t.each(function(t){var i=n.select(this);i.attr("transform")||i.attr("transform","translate("+(r(t.parent?t.parent.x:t.x)+o)+","+a(t.parent?t.parent.y:t.y)+")"),t.children.length&&!t.data.expanded?i.attr("cursor","pointer").on("click",function(){n.select(this).dispatch("change",{bubbles:!0,cancelable:!0})}).on("change",function(t){return t.data.expanded=!t.data.expanded}):i.attr("cursor","").on("click",null),e&&(i=i.transition(e)),t.data.expanded?i.style("opacity",0).selectAll("*").remove():i.style("opacity",null).call(p.point),i.attr("transform","translate("+(r(t.x)+o)+", "+a(t.y)+")"),rt(i,p.annotation,"d2b-bubble-annotation")})}function d(t){t.each(function(t){var e=n.select(this).classed("d2b-active",t.data.expanded);if(!t.data.expanded)return e.selectAll("rect, text, path").remove();var r=e.select("rect"),o=e.select("text"),i=e.select("path");r.size()||(r=e.append("rect")),o.size()||(o=e.append("text")),i.size()||(i=e.append("path")),o.text(function(t){return t.indicator.substring(0,5)}).attr("x",20);var l=o.node().getBBox();o.attr("y",l.height/1.35),r.on("click",function(){n.select(this).dispatch("change",{bubbles:!0,cancelable:!0})}).on("change",function(t){t.data.expanded=!t.data.expanded,t.data.expanded||a(t,!1)}).attr("width",l.width+25).attr("height",l.height).style("fill",p.point.fill()).style("stroke",p.point.stroke()),i.attr("d",function(t){return b.type(t.symbol)()}).attr("transform","translate(10, 9.5)").style("fill",p.point.stroke())})}function u(t,e,r,a,o,i,l,s,p,f,b){var h=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,y=t.selectAll(".d2b-bubble-pack.d2b-depth-"+h).data(e,function(t){return t.key}),g=y.enter().append("g").attr("class","d2b-bubble-pack d2b-depth-"+h),x=y.merge(g),m=g.append("g").attr("class","d2b-bubble-point");b&&c(m,!1,i,l,s),m.style("opacity",0),c(x.select(".d2b-bubble-point"),r,a,o,s),g.append("g").attr("class","d2b-bubble-indicator"),d(x.select(".d2b-bubble-indicator")),x.each(function(t){var e=n.select(this),c=e.selectAll(".d2b-bubble-pack");c=r?c.transition(r):c,t.children.length&&t.data.expanded?u(e,t.children,r,a,o,i,l,s,p,f,b,h+1):(f&&f(t),c.remove().select(".d2b-bubble-point").style("opacity",0).attr("transform","translate("+[a(t.x)+s,o(t.y)]+")"))});var v=y.exit();r&&(v=v.transition(r)),v.remove()}function s(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;t.children=t.children||[],t.leaves=t.children.length?[]:[t],t.depth=r,t.children.length&&t.children.forEach(function(n){s(n,e,r+1),n.parent=t,t.leaves=t.leaves.concat(n.leaves)}),t.size=i(t.size,n.sum(t.leaves,function(t){return t.size})),t.x=i(t.x,(e.x||e)(t.leaves,function(t){return t.x},function(t){return t.size})),t.y=i(t.y,(e.y||e)(t.leaves,function(t){return t.y},function(t){return t.size}))}var p={},b=n.symbol().size(80),h=function t(e){var a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=e.selection?e:null,i=e.selection?e.selection():e,c=i.selectAll(".d2b-bubble-pack-graphs").data(function(t){return[t]});c=c.merge(c.enter().append("g").attr("class","d2b-bubble-pack-graphs"));var d=c.selectAll(".d2b-bubble-pack-graph").data(function(t,n){return r(t,n)},function(t){return t.key}),s=d.enter().append("g").attr("class","d2b-bubble-pack-graph d2b-graph"),f=d.merge(s).order(),b=d.exit();return o&&(f=f.transition(o),b=b.transition(o)),f.style("opacity",1),b.style("opacity",0).remove(),e.each(function(e,r){var i=n.select(this),c=p.duration(e,r),d=i.selectAll(".d2b-bubble-pack-graph"),s=i.selectAll(".d2b-bubble-pack-graphs").node(),f=s.__d2bPreserveScaleX__||p.x,b=s.__d2bPreserveScaleY__||p.y;i.on("change",function(){i.transition().duration(c).call(t,!1)});var h=0;d.each(function(t){var e=n.select(this),r=p.x.range();h=Math.max(h,Math.abs(r[0]-r[1]));var l=t.shift;null===l&&(l=p.x.bandwidth?p.x.bandwidth()/2:0),p.point.active(function(t){return!!t.children.length}).fill(function(t){return t.color}).type(function(t){return t.symbol});var c=t.tooltipGraph?t.tooltipGraph.clear().x(function(t){return p.x(t.x)+l}).y(function(t){return p.y(t.y)}).color(function(t){return t.color}).addPoint:null;u(e,t.values,o,p.x,p.y,f,b,l,i,c,a)}),l(i,h)}),c.each(function(){this.__d2bPreserveScaleX__=p.x.copy(),this.__d2bPreserveScaleY__=p.y.copy()}),i.dispatch("svg-bubble-pack-updated",{bubbles:!0}),t};return f(h,p).addProp("point",z().size(function(t){return 100*t.size})).addProp("x",n.scaleLinear()).addProp("y",n.scaleLinear()).addProp("annotation",e.annotation?e.annotation():null).addPropGet("type","bubblePack").addPropFunctor("duration",250).addPropFunctor("graphs",function(t){return t}).addPropFunctor("tendancy",k,function(t){return arguments.length?(t&&t.tendancy?p.tendancy=function(){return t}:p.tendancy=o(t),h):p.tendancy}).addPropFunctor("tooltipGraph",function(t){return t.tooltipGraph}).addPropFunctor("shift",null).addPropFunctor("key",function(t){return t.label}).addPropFunctor("values",function(t){return t.values}).addPropFunctor("color",function(t){return U(t.label)}).addPropFunctor("symbol",function(){return n.symbolCircle}).addPropFunctor("px",function(t){return t.x}).addPropFunctor("py",function(t){return t.y}).addPropFunctor("psize",function(t){return t.size}).addPropFunctor("pchildren",function(t){return t.children}).addPropFunctor("pcolor",null).addPropFunctor("psymbol",null).addPropFunctor("pindicator",function(t){return t.label}).addPropFunctor("pkey",function(t,n){return n}).addPropFunctor("pannotation",function(t){return t.annotation}).addMethod("getComputedGraphs",function(t){return(t.selection?t.selection():t).data().map(function(t,n){return r(t,n)})}).addMethod("getVisiblePoints",function(t){function n(t,e,r){t.data.expanded?t.children.forEach(function(t){return n(t,e,r)}):e.push({x:t.x,y:t.y,graph:r})}return h.getComputedGraphs(t).map(function(t){return[].concat.apply([],t.map(function(t){var e=[];return t.values.forEach(function(r){return n(r,e,t)}),e}))})[0]}),h}function S(){function t(t){return e(n.hierarchy(t,g.children).sum(g.size))}function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(t.key=g.key(t.data,n),t.color=g.color(t.data,n),t.label=g.label(t.data,n),t.children)return t.children.forEach(e),t}function r(t){var n=null;return t.each(function(t){t.data.selected&&(n=t)}),n||(n=t),n.data.selected=!0,n}function a(t,n){t.ancestors().concat(t.descendants()).filter(function(t){return t.depth<=n&&t.value>0}).forEach(function(t){return t.visible=!0})}function o(t,n,e,r){var a=g.innerRadius(t,n),o=g.outerRadius(t,n),i=g.ancestorPadding(t,n),l=g.ancestorRatio(t,n),c=0;e.each(function(t){t.visible&&(c=Math.max(c,t.depth))});var d=o-a-i,u=a+d*l,s=g.ancestorBanding.copy().range([a,u]).domain([0,r.depth+1]),p=g.descendantBanding.copy().range([u+i,o]).domain([r.depth+1,c+1]);return function(t){var n=void 0;return n=t<=r.depth?s:p,{inner:n(t),outer:n(t+1)}}}function l(t){return t>Math.PI?A(t)+90:A(t)-90}function c(t,n){var e=(n.inner-n.outer)/2.2;return t>Math.PI?-e:e}function u(t){return t>Math.PI?"end":"start"}function s(t,e,r,a,o,i){var f="arc"===e?d:p;t=t.filter(function(t){return t.visible}),g.pie.startAngle(a).endAngle(o),g.pie(t).forEach(function(t){var n=i.radii(t.data.depth);t.data.startAngle=t.startAngle,t.data.endAngle=t.endAngle,t.data.padAngle=t.padAngle,t.data.innerRadius=n.inner,t.data.outerRadius=n.outer,t.data.centerAngle=(t.startAngle+t.endAngle)/2,t.data.rotate=l(t.data.centerAngle),t.data.labelOffset=c(t.data.centerAngle,n),t.data.labelAnchor=u(t.data.centerAngle)});var h=n.select(this),y="d2b-sunburst-level-"+r,m=h.selectAll(".d2b-sunburst-"+e+"-group."+y),v=m.data();m=m.data(t,function(t){return t.key});var k=m.enter().append("g").attr("class","d2b-sunburst-"+e+"-group "+y),P=k.append("arc"===e?"path":"text").attr("class","d2b-sunburst-"+e+" "+y).each(function(n,e){var r=i.oldRadii(n.depth),a=n.neighbor||b(e,v,t);this.current={startAngle:a.startAngle,endAngle:a.endAngle,innerRadius:r.inner,outerRadius:r.outer,rotate:l((a.startAngle+a.endAngle)/2)},n.children&&n.children.forEach(function(t){return t.neighbor=a})});k.append("g").attr("class","d2b-sunburst-"+e+"-children "+y),"arc"===e?P.style("fill",function(t){return t.color}):P.style("opacity",0).attr("y",4);var w=m.exit();m=m.merge(k),m.select(".d2b-sunburst-"+e+"."+y).classed("d2b-sunburst-ancestor",function(t){return t.depth<t.selected.depth}),
i.transition&&(w.each(function(r,a){var o=b(a,t,v),d=n.select(this),u=d.selectAll(".d2b-sunburst-"+e).datum(function(t){var n=i.radii(t.depth);return t.innerRadius=n.inner,t.outerRadius=n.outer,t.startAngle=o.startAngle,t.endAngle=o.endAngle,t.centerAngle=o.centerAngle,t.rotate=l(t.centerAngle),t.labelOffset=c(t.centerAngle,n),t}).transition(i.transition).call(f,x);"label"===e&&u.style("opacity",0).attr("x",function(t){return t.labelOffset})}),w=w.transition(i.transition),m=m.transition(i.transition)),w.remove();var F=m.select(".d2b-sunburst-"+e+"."+y).call(f,x);"arc"===e?F.style("fill",function(t){return t.color}):F.text(function(t){return t.depth>=t.selected.depth?t.label:""}).style("opacity",1).attr("x",function(t){return t.labelOffset}).style("text-anchor",function(t){return t.labelAnchor}),m.select(".d2b-sunburst-"+e+"-children."+y).each(function(t){var n=t.children||[];s.call(this,n,e,r+1,t.startAngle,t.endAngle,i)})}function b(t,n,e){var r=h(t,n,e),a=y(t,n,e);return r?{startAngle:r.endAngle,endAngle:r.endAngle}:a?{startAngle:a.startAngle,endAngle:a.startAngle}:{startAngle:0,endAngle:0,centerAngle:0}}function h(t,n,e){for(var r=n.length;--t>=0;)for(var a=e[t].key,o=0;o<r;++o)if(n[o].key===a)return n[o]}function y(t,n,e){for(var r=e.length,a=n.length;++t<r;)for(var o=e[t].key,i=0;i<a;++i)if(n[i].key===o)return n[i]}var g={},x=n.arc(),m=function e(l){var c=l.selection?l.selection():l;return g.pie.value(function(t){return t.value}),c.each(function(d,u){var p=n.select(this),f=g.zoomable(d,u),b=g.highlight(d,u),h=g.innerRadius(d,u),y=g.showLabels(d,u),x=t(d),m=r(x);a(m,g.descendantLevels(d,u)+m.depth),x.each(function(t){return t.selected=m});var v=o(d,u,x,m);s.call(this,[x],"arc",0,g.startAngle(d,u),g.endAngle(d,u),{transition:l!==c?l:null,oldRadii:i(this.__radii,v),radii:v,zoomable:f}),s.call(this,y?[x]:[],"label",0,g.startAngle(d,u),g.endAngle(d,u),{transition:l!==c?l:null,oldRadii:i(this.__radii,v),radii:v});var k=p.selectAll(".d2b-sunburst-center");k.data([m]).enter().append("circle").attr("class","d2b-sunburst-center").merge(k).attr("cx",0).attr("cy",0).attr("r",Math.max(0,h)).on("click",function(t){t.parent&&(t.data.selected=!1,t.parent.data.selected=!0,p.transition().duration(g.duration(t,u)).call(e))}),this.__radii=v,p.selectAll("path.d2b-sunburst-arc").on("click",f?function(t){x.each(function(t){return t.data.selected=!1}),t.data.selected=!0,p.transition().duration(g.duration(d,u)).call(e)}:null).on("mouseover",b?function(t){var n=t.ancestors();p.selectAll(".d2b-sunburst-arc").classed("d2b-transparent",function(t){return-1===n.indexOf(t)}),p.selectAll(".d2b-sunburst-label").classed("d2b-transparent",function(t){return-1===n.indexOf(t)})}:null).on("mouseout",function(){p.selectAll(".d2b-sunburst-arc").classed("d2b-transparent",!1),p.selectAll(".d2b-sunburst-label").classed("d2b-transparent",!1)})}),c.dispatch("svg-sunburst-updated",{bubbles:!0}),e};return f(m,g).addProp("pie",n.pie().sort(null)).addProp("ancestorBanding",n.scaleLinear()).addProp("descendantBanding",n.scalePow().exponent(.85)).addPropFunctor("duration",250).addPropFunctor("innerRadius",30).addPropFunctor("outerRadius",200).addPropFunctor("ancestorPadding",10).addPropFunctor("ancestorRatio",.2).addPropFunctor("descendantLevels",1/0).addPropFunctor("startAngle",0).addPropFunctor("endAngle",2*Math.PI).addPropFunctor("showLabels",!1).addPropFunctor("zoomable",!0).addPropFunctor("highlight",!0).addPropFunctor("key",function(t){return g.label(t)}).addPropFunctor("label",function(t){return t.label}).addPropFunctor("color",function(t){return U(g.label(t))}).addPropFunctor("children",function(t){return t.children}).addPropFunctor("size",function(t){return t.size}),m}function N(){var t={},e=function e(r){var o=r.selection?r.selection():r;return o.each(function(e){function i(t){return c(t)?x+5:-5}function c(t){return t.x0<b.width/2}function d(t){return 5+Math.max(0,t.y1-t.y0)/2}function u(e){if(e.draggableX&&(e.x0=Math.max(0,Math.min(b.width-x,e.x0+n.event.dx)),e.x1=e.x0+x,this.__dragX0=e.x0/b.width),e.draggableY){var r=e.y1-e.y0;e.y0=Math.max(0,Math.min(b.height-(e.y1-e.y0),e.y0+n.event.dy)),e.y1=e.y0+r,this.__dragY0=e.y0/b.height}t.sankey.update(m),s()}function s(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Y.select("text").classed("d2b-text-anchor-end",function(t){return!c(t)}).call(l,function(t){return t.label},function(t){return t.wrapLength},"middle");var e=t?M:T,r=t?R:Y;e.style("opacity",1).select("path").attr("d",h).style("stroke",function(t){return"url(#"+t.keyTrim+")"}).style("stroke-width",function(t){return t.width+"px"}),e.each(function(e){var r=n.select(this);if(Math.abs(e.y1-e.y0)<1e-5){var a=r.selectAll("rect").data([e]),o=a.enter().append("rect"),i=e.target.x0-e.source.x1;a=a.merge(o),t&&(a=a.transition(t)),a.attr("x",e.source.x1+Math.min(0,i)).attr("y",e.y0-e.width/2).attr("height",Math.max(0,e.width)).attr("width",Math.abs(e.target.x0-e.source.x1)).style("fill","url(#"+e.keyTrim+")"),r.select("path").style("display","none")}else r.select("rect").remove(),r.select("path").style("display","")}),r.attr("transform",function(t){return"translate("+t.x0+", "+t.y0+")"}).style("opacity",1),r.select("rect").attr("width",Math.max(0,x)).attr("height",function(t){return Math.max(0,t.y1-t.y0)}).style("fill",function(t){return t.color}),r.select("text").attr("x",i).attr("y",d)}var p=r===o?null:r,f=n.select(this),b=t.size(e),h=a.sankeyLinkHorizontal(),y=t.nodes(e).map(function(n,e){var r=t.nodeKey(n,e);return{key:r,label:t.nodeLabel(n,e,r),color:t.nodeColor(n,e,r),draggableX:t.nodeDraggableX(n,e),draggableY:t.nodeDraggableY(n,e),preserveDragging:t.nodePreserveDragging(n,e),wrapLength:t.nodeLabelWrapLength(n,e),data:n,index:e}}),g=t.links(e).map(function(n,e){var r=t.linkSource(n,e),a=t.linkTarget(n,e),o="object"===(void 0===r?"undefined":nt(r))?t.nodeKey(r):r,i="object"===(void 0===a?"undefined":nt(a))?t.nodeKey(a):a,l=t.linkKey(n,e,o,i);return{sourceKey:o,targetKey:i,key:l,keyTrim:l.replace(/ /g,""),sourceColor:t.linkSourceColor(n,e,o),targetColor:t.linkTargetColor(n,e,i),value:t.linkValue(n,e),source:r,target:a,data:n,index:e}});t.sankey.size([b.width,b.height]).nodeId(function(t){return t.key}).nodes(y).links(g);var x=t.sankey.nodeWidth(),m=t.sankey.nodes(y).links(g)();m.links=m.links.filter(function(t){return!!t.value}),m.nodes=m.nodes.filter(function(t){return!!t.value}),m=t.sankey.nodes(m.nodes).links(m.links)();var v=f.selectAll(".d2b-sankey-link-defs").data([m.links]),k=v.enter().append("defs").attr("class","d2b-sankey-link-defs");v=v.merge(k);var P=v.selectAll(".d2b-def-gradient").data(function(t){return t},function(t){return t.keyTrim}),w=P.enter().append("linearGradient").attr("class","d2b-def-gradient"),F=P.exit();w.append("stop").attr("class","d2b-gradient-from").attr("offset","0%"),w.append("stop").attr("class","d2b-gradient-to").attr("offset","100%"),P=P.merge(w),p&&(F=F.transition(p),P=P.transition(p)),F.remove(),P.attr("id",function(t){return t.keyTrim}),P.select(".d2b-gradient-from").attr("stop-color",function(t){return t.sourceColor}),P.select(".d2b-gradient-to").attr("stop-color",function(t){return t.targetColor});var _=f.selectAll(".d2b-sankey-links").data([m.links]),A=_.enter().append("g").attr("class","d2b-sankey-links");_=_.merge(A);var M=_.selectAll(".d2b-sankey-link").data(function(t){return t},function(t){return t.key}),z=M.enter().append("g").attr("class","d2b-sankey-link"),E=M.exit(),T=M=M.merge(z);p&&(M=M.transition(p),E=E.transition(p));var G=f.selectAll(".d2b-sankey-nodes").data([m.nodes]),C=G.enter().append("g").attr("class","d2b-sankey-nodes");G=G.merge(C);var R=G.selectAll(".d2b-sankey-node").data(function(t){return t},function(t){return t.key}),B=R.enter().append("g").attr("class","d2b-sankey-node"),X=R.exit(),Y=R=R.merge(B);p&&(R=R.transition(p),X=X.transition(p)),R.each(function(t){if(t.draggableX||t.draggableY?n.select(this).classed("d2b-draggable",!0).call(n.drag().on("drag",u)):n.select(this).classed("d2b-draggable",!1).on(".drag",null),t.preserveDragging&&(void 0!==this.__dragX0&&(t.x0=this.__dragX0*b.width,t.x1=t.x0+x),void 0!==this.__dragY0)){var e=t.y1-t.y0;t.y0=this.__dragY0*b.height,t.y1=t.y0+e}}),t.sankey.update(m),z.style("opacity",0).append("path").attr("d",h).style("stroke",function(t){return"url(#"+t.keyTrim+")"}).style("stroke-width",function(t){return t.width+"px"}),E.style("opacity",0).remove(),B.attr("transform",function(t){return"translate("+t.x0+", "+t.y0+")"}).style("opacity",0),B.append("rect").attr("width",Math.max(0,x)).attr("height",function(t){return Math.max(0,t.y1-t.y0)}),B.append("text").attr("x",i).attr("y",d),X.style("opacity",0).remove(),s(p)}),o.dispatch("svg-sankey-updated",{bubbles:!0}),e};return f(e,t).addProp("sankey",a.sankey()).addPropFunctor("size",{width:960,height:500}).addPropFunctor("nodes",function(t){return t.nodes}).addPropFunctor("nodeKey",function(t){return t.name}).addPropFunctor("nodeLabel",function(t,n,e){return e}).addPropFunctor("nodeLabelWrapLength",1/0).addPropFunctor("nodeDraggableX",!1).addPropFunctor("nodeDraggableY",!1).addPropFunctor("nodePreserveDragging",!0).addPropFunctor("nodeColor",function(t,n,e){return U(e)}).addPropFunctor("links",function(t){return t.links}).addPropFunctor("linkSource",function(t){return t.source}).addPropFunctor("linkSourceColor",function(t,n,e){return U(e)}).addPropFunctor("linkTarget",function(t){return t.target}).addPropFunctor("linkTargetColor",function(t,n,e){return U(e)}).addPropFunctor("linkKey",function(t,n,e,r){return e+"-"+r}).addPropFunctor("linkValue",function(t){return t.value}),e}function j(){function t(t,n,e,r,a){var o=[],i=[],l=t.data;l&&(u(t,l,n,e,r),o=[l],t.info.showGrid&&(i=[l])),t.update=e.selectAll(".d2b-"+t.type+"-axis").data(o),t.enter=t.update.enter().append("g").attr("class","d2b-axis d2b-"+t.type+"-axis"),t.labelEnter=t.enter.append("text").attr("class","d2b-axis-label"),t.svg=t.enter.merge(t.update),t.label=t.svg.select(".d2b-axis-label"),t.update.exit().remove(),t.gridUpdate=e.selectAll(".d2b-"+t.type+"-grid").data(i),t.gridEnter=t.gridUpdate.enter().append("g").attr("class","d2b-grid d2b-"+t.type+"-grid"),t.gridUpdate.exit().remove(),t.grid=t.gridEnter.merge(t.gridUpdate),a&&(t.svg=t.svg.transition(a),t.update=t.update.transition(a),t.grid=t.grid.transition(a),t.gridUpdate=t.gridUpdate.transition(a),t.label=t.label.transition(a))}function e(t,n,e,r){t.data&&(c(t),d(t,n),t.enter.call(t.info.axis).attr("transform","translate("+e+", "+r+")"),t.update.call(t.info.axis).attr("transform","translate("+e+", "+r+")"),t.svg.call(g,t).on("end",function(){t.svg.call(g,t)}))}function r(t,n,e){t.data&&(o(t,e),d(t,n),t.gridUpdate.call(t.info.axis).selectAll(".tick text").remove(),t.gridEnter.call(t.info.axis).selectAll(".tick text").remove())}function a(t,n){t.data&&(t.labelEnter.text(t.info.label).attr("x",h(t,n)).attr("y",b(t)).attr("text-anchor",s(t)),t.label.text(t.info.label).attr("x",h(t,n)).attr("y",b(t)).attr("text-anchor",s(t)))}function o(t,n){if(t.data)switch(t.type){case"x":return t.info.axis.tickSize("inner"===t.info.orient?-n:n);case"x2":case"y":return t.info.axis.tickSize("inner"===t.info.orient?n:-n);case"y2":return t.info.axis.tickSize("inner"===t.info.orient?-n:n)}}function c(t){t.data&&t.info.axis.tickSizeOuter(0).tickSizeInner(t.info.tickSize)}function d(t,n){t.data&&(["y","y2"].indexOf(t.type)>-1?t.info.axis.scale().range([n,0]):t.info.axis.scale().range([0,n]))}function u(t,n,e,r,a){if(t.data){var o=t.info={};o.axis=v.axis(n,e),o.orient=v.orient(n,e),o.wrapLength=v.wrapLength(n,e),o.label=i(v.label(n,e),""),o.labelOrient=v.labelOrient(n,e),o.tickSize=v.tickSize(n,e),o.showGrid=v.showGrid(n,e),o.labelOrient1=o.labelOrient.split(" ")[0],o.labelOrient2=o.labelOrient.split(" ")[1],o.wrapAnchor=p(t),c(t),d(t,a);var l=r.append("g").attr("class","d2b-axis d2b-"+t.type+"-axis").call(o.axis).call(g,t);o.axisBox=l.node().getBBox();var u=l.append("text").attr("class","d2b-axis-label d2b-"+t.type+"-label").text(o.label);o.labelBox=u.node().getBBox(),l.remove()}}function s(t){if(t.data){var n=t.info,e=["y","y2"].indexOf(t.type)>-1;return"start"===n.labelOrient2&&e?"end":"end"!==n.labelOrient2||e?"middle"===n.labelOrient2?"middle":"start":"end"}}function p(t){if(t.data)switch(t.type){case"x":return"inner"===t.info.orient?"end":"start";case"x2":return"outer"===t.info.orient?"end":"start";case"y":case"y2":return"middle";default:return"start"}}function b(t){if(t.data){var n=t.info;switch(t.type+" "+n.orient+" "+n.labelOrient1){case"x inner inner":case"x2 outer outer":return-n.axisBox.height-k;case"x inner outer":case"x2 outer inner":return n.labelBox.height+k;case"x outer inner":case"x2 inner outer":case"y inner outer":case"y2 outer inner":return-k;case"x outer outer":case"x2 inner inner":return n.labelBox.height+n.axisBox.height+k;case"y inner inner":case"y2 outer outer":return n.labelBox.height+n.axisBox.width+k;case"y outer inner":case"y2 inner outer":return n.labelBox.height+k;case"y outer outer":case"y2 inner inner":return-n.axisBox.width-k}}}function h(t,n){if(t.data)return"start"===t.info.labelOrient2?0:"middle"===t.info.labelOrient2?n/2:n}function y(t){var n={top:0,left:0,right:0,bottom:0};return t.x.data&&("outer"===t.x.info.orient&&(n.bottom+=t.x.info.axisBox.height),"outer"===t.x.info.labelOrient1&&(n.bottom+=t.x.info.labelBox.height+k)),t.x2.data&&("outer"===t.x2.info.orient&&(n.top+=t.x2.info.axisBox.height),"outer"===t.x2.info.labelOrient1&&(n.top+=t.x2.info.labelBox.height)),t.y.data&&("outer"===t.y.info.orient&&(n.left+=t.y.info.axisBox.width),"outer"===t.y.info.labelOrient1&&(n.left+=t.y.info.labelBox.height)),t.y2.data&&("outer"===t.y2.info.orient&&(n.right+=t.y2.info.axisBox.width),"outer"===t.y2.info.labelOrient1&&(n.right+=t.y2.info.labelBox.height+k)),n.top=Math.max(n.top,10),n.bottom=Math.max(n.bottom,10),n.left=Math.max(n.left,10),n.right=Math.max(n.right,10),n}function g(t,e){if(e.data){var r=e.info.wrapLength,a=e.info.wrapAnchor;t.selectAll(".tick text").each(function(){var t=n.select(this);-1===i(t.html(),"").indexOf("tspan")&&(this.storeText=t.text()),t.text("")}).call(l,function(){return this.storeText},r,a)}}function x(t){return"number"==typeof t?{top:t,left:t,right:t,bottom:t}:t}function m(t){return x(t||0)}var v={},k=5,P=function o(i){var l=i.selection?i.selection():i;return l.each(function(o,c){var d=v.size.call(this,o,c)||{width:960,height:500},u=m(v.margin.call(this,o,c)),s=v.x.call(this,o,c),p=v.x2.call(this,o,c),f=v.y.call(this,o,c),b=v.y2.call(this,o,c),h=n.select(this),g={x:{type:"x",data:s},x2:{type:"x2",data:p},y:{type:"y",data:f},y2:{type:"y2",data:b}},k=x(v.padding.call(this,o,c)),P=h.selectAll(".d2b-plane").data([o]),w=P.enter().append("g").attr("class","d2b-plane"),F=P.merge(w),_=this.__clipID=this.__clipID||"d2b-clip-plane-"+V();w.append("defs").append("clipPath").attr("id",_).attr("class","d2b-clip-plane").append("rect");var A=i!==l?i:null;t(g.x,c,F,d.width,A),t(g.x2,c,F,d.width,A),t(g.y,c,F,d.height,A),t(g.y2,c,F,d.height,A),k||(k=y(g));var M={top:k.top+u.top,bottom:k.bottom+u.bottom,left:k.left+u.left,right:k.right+u.right};M.width=d.width-M.left-M.right,M.height=d.height-M.top-M.bottom,this.__box__=M,A&&(P=P.transition(A)),w.attr("transform","translate("+M.left+", "+M.top+")"),P.attr("transform","translate("+M.left+", "+M.top+")"),e(g.x,M.width,0,M.height),e(g.x2,M.width,0,0),e(g.y,M.height,0,0),e(g.y2,M.height,M.width,0),r(g.x,M.width,M.height),r(g.x2,M.width,M.height),r(g.y,M.height,M.width),r(g.y2,M.height,M.width),a(g.x,M.width),a(g.x2,M.width),a(g.y,-M.height),a(g.y2,-M.height),F.select(".d2b-clip-plane").select("rect").attr("width",M.width+1).attr("height",M.height+1),F.selectAll(".d2b-grid").attr("clip-path","url(#"+_+")")}),l.dispatch("plane-updated",{bubbles:!0}),o};return f(P,v).addPropFunctor("size",function(t){return t.size}).addPropFunctor("padding",null).addPropFunctor("margin",0).addPropFunctor("x",function(t){return t.x}).addPropFunctor("x2",function(t){return t.x2}).addPropFunctor("y",function(t){return t.y}).addPropFunctor("y2",function(t){return t.y2}).addPropFunctor("axis",function(t){return t.axis}).addPropFunctor("orient",function(t){return t.orient||"outer"}).addPropFunctor("wrapLength",function(t){return i(t.wrapLength,1/0)}).addPropFunctor("tickSize",function(t){return i(t.tickSize,6)}).addPropFunctor("showGrid",function(t){return!1!==t.showGrid}).addPropFunctor("label",function(t){return t.label}).addPropFunctor("labelOrient",function(t){return t.labelOrient||"outer middle"}).addMethod("box",function(t){var n=t.node?t.node():t;return n?n.__box__:null}),P}function Q(){function t(t,c){var d=n.select(this),u=d.select(".d2b-chart-container"),f=u.node().__size__,b=o.radius(t,f.width,f.height),h=o.donutRatio(t),y=o.legend.empty(),g=o.values(t),x=g.filter(function(t){return!y(t)});o.pie.values(x),o.legend.values(g),d.select(".d2b-legend-container").call(o.legend).on("change",function(){return d.transition(o.duration(t)).call(i)}).selectAll(".d2b-legend-item").on("mouseover",function(t){r.call(this,d,t)}).on("mouseout",function(t){a.call(this,d,t)});var m=n.sum(x,function(t){return o.value(t)}),v=u.selectAll(".d2b-pie-chart").data([x]),k=v.enter().append("g").attr("class","d2b-pie-chart");v=v.merge(k),c&&(v=v.transition(c)),o.pie.arc().innerRadius(b*h).outerRadius(b),v.call(o.pie);var P=u.selectAll(".d2b-pie-arc").each(function(t){t.__innerRadius__=b*h,t.__outerRadius__=b,t.__percent__=t.value/m}).on("mouseover",function(t){r.call(this,d,t.data)}).on("mouseout",function(t){a.call(this,d,t.data)}).call(o.tooltip);P.selectAll(".d2b-pie-arc-percent").data(function(t){return[t]}).enter().append("g").attr("class","d2b-pie-arc-percent").append("text").attr("y",6),P.each(function(){var t=n.select(this),e=t.select(".d2b-pie-arc path").node().current,r=t.select(".d2b-pie-arc-percent"),a=r.select("text").node();r.node().current=e,a.current=a.current||0}),c&&(P=P.each(function(){this.transitioning=!0}).transition(c).on("end",function(){this.transitioning=!1})),P.select(".d2b-pie-arc-percent").call(p,o.pie.arc()).select("text").call(s,function(t){return o.value(t.data)/m},l).style("opacity",function(t){return o.showPercent.call(this,t.data,m)?1:0});var w=e(t,b,f);k.attr("transform","translate("+w.x+", "+w.y+")"),v.attr("transform","translate("+w.x+", "+w.y+")")}function e(t,n,e){var r=o.at(t,e.width,e.height,n);if("object"!==(void 0===r?"undefined":nt(r))){r=r.split(" ");var a={x:r[1],y:r[0]};switch(r={},a.x){case"left":r.x=n;break;case"center":case"middle":r.x=e.width/2;break;case"right":default:r.x=e.width-n}switch(a.y){case"bottom":r.y=e.height-n;break;case"center":case"middle":r.y=e.height/2;break;case"top":default:r.y=n}}return r}function r(t,n){var e=o.pie.arc();e.outerRadius(function(t){return t.outerRadius}).innerRadius(function(t){return t.innerRadius}),t.selectAll(".d2b-pie-arc").filter(function(t){return t.data===n}).each(function(t){t.outerRadius=1.03*t.__outerRadius__,t.innerRadius=t.__innerRadius__}).select("path").transition().duration(100).call(d,e)}function a(t,n){var e=o.pie.arc();e.outerRadius(function(t){return t.outerRadius}).innerRadius(function(t){return t.innerRadius}),t.selectAll(".d2b-pie-arc").filter(function(t){return t.data===n}).each(function(t){t.outerRadius=t.__outerRadius__,t.innerRadius=t.__innerRadius__}).select("path").transition().duration(100).call(d,e)}var o={},i=function e(r){r.call(o.chartFrame),o.pie.value(o.value).color(o.color).key(o.key),o.legend.html(o.label).key(o.key).color(o.color),o.tooltip.color(function(t){return n.rgb(o.color(t.data)).darker(.3)});var a=r.selection?r.selection():r;return a.each(function(n){t.call(this,n,r!==a?r:null)}),a.dispatch("chart-pie-updated",{bubbles:!0}),e},l=n.format(".0%");return f(i,o).addProp("chartFrame",m().legendEnabled(!0).breadcrumbsEnabled(!1)).addProp("legend",x().clickable(!0).dblclickable(!0)).addProp("key",function(t){return t.label}).addProp("pie",E()).addProp("tooltip",b().followMouse(!0).html(function(t){return"<b>"+o.label(t.data)+"</b>: "+o.value(t.data)+" ("+l(t.__percent__)+")"})).addPropFunctor("values",function(t){return t}).addPropFunctor("duration",250).addPropFunctor("donutRatio",0).addPropFunctor("at","center center").addPropFunctor("showPercent",function(t,n){return o.value(t)/n>.03}).addPropFunctor("radius",function(t,n,e){return Math.min(n,e)/2}).addPropFunctor("color",function(t){return U(t.label)}).addPropFunctor("value",function(t){return t.value}).addPropFunctor("label",function(t){return t.label}),i}function I(){function t(t,e){var o=n.select(this),f=o.select(".d2b-chart-container"),b=f.node(),x=o.select(".d2b-legend-container"),m=f.node().__size__,v=a(t),k=l(v),w=y.duration(t),F=r(t,v),_=y.clipPlane(t),A=(y.annotations(t)||[]).slice().map(function(t,n){return{key:y.annotationKey(t,n),xType:y.annotationXType(t)||"x",yType:y.annotationYType(t)||"y",z:y.annotationZ(t)||"front",x:y.annotationX(t),y:y.annotationY(t),x2:y.annotationX2(t),y2:y.annotationY2(t),color:y.annotationColor(t)||"steelblue",data:t}});c(F);var M=b.tooltip=b.tooltip||h().trackX(!0).trackY(!1).threshold(50);M.title(function(t){return""+i(t[0].x,t[0].x1,t[0].median)}).clear(),y.legend.values(F),x.call(y.legend).on("change",function(){return o.transition().duration(w).call(g)}).selectAll(".d2b-legend-item").on("mouseover",function(t){return d(t,f)}).on("mouseout",function(t){return u(t,f)}),y.plane.size(m);var z=f.selectAll(".d2b-axis-plane").data([t]),E=z,T=z.enter().append("g").attr("class","d2b-axis-plane");E=z=z.merge(T);var G=f.selectAll(".d2b-axis-wrapper").data([t]),C=G,R=G.enter().append("g").attr("class","d2b-axis-wrapper");R.append("rect").attr("class","d2b-axis-background"),R.append("g").attr("class","d2b-axis-back-annotations"),R.append("g").attr("class","d2b-axis-sets"),R.append("g").attr("class","d2b-axis-front-annotations"),C=G=G.merge(R);var B=G.select(".d2b-axis-back-annotations"),X=G.select(".d2b-axis-front-annotations"),Y=G.select(".d2b-axis-sets").selectAll(".d2b-axis-set").data(v,function(t){return t.key}),O=Y.enter().append("g").attr("class","d2b-axis-set"),L=Y.exit();Y=Y.merge(O).order(),e&&(L=L.transition(e),C=C.transition(e),E=E.transition(e),B=B.transition(e),X=X.transition(e));var S={x:[],x2:[],y:[],y2:[]};Y.each(function(t){var e=n.select(this),r=t.graphs.filter(function(t){return!t.data.hidden}),a=r.map(function(t){return t.data});r.forEach(function(n){A=A.concat(n.annotations.map(function(e,r){return{key:t.key+"-"+n.key+"-"+y.annotationKey(e,r),xType:t.xType,yType:t.yType,z:y.annotationZ(e)||"front",x:y.annotationX(e),y:y.annotationY(e),x2:y.annotationX2(e),y2:y.annotationY2(e),color:y.annotationColor(e)||n.color,data:e,graph:n.data}}))}),this.genUpdate=e.selectAll(".d2b-graph-generator").data(t.generators.slice().reverse(),function(t){return t.key}),this.genEnter=this.genUpdate.enter().append("g").attr("class","d2b-graph-generator").style("opacity",0),this.genExit=this.genUpdate.exit(),this.gen=this.genUpdate.merge(this.genEnter).order();var o=this.gen.size();this.gen.each(function(e,r){var i=n.select(this),l=e.generator.tooltipGraph(function(t){if(r<o-1)return null;var n=M.graph(V());return s(t,k).tooltipConfig(n),n}).color(function(t){return s(t,k).color}).graphs(a).getVisiblePoints(i);e.generator.duration&&e.generator.duration(w),l.forEach(function(n){S[t.xType].push(n.x),S[t.yType].push(n.y)})})});var N=y.x(t,S.x),j=y.y(t,S.y),Q=y.x2(t,S.x2),I=y.y2(t,S.y2);p(N,S.x,P.x),p(j,S.y,P.y),p(Q,S.x2,P.x2),p(I,S.y2,P.y2),y.plane.axis(function(t){return t.__axis__}).x(N.__axis__&&S.x.length?N:null).y(j.__axis__&&S.y.length?j:null).x2(Q.__axis__&&S.x2.length?Q:null).y2(I.__axis__&&S.y2.length?I:null),T.call(y.plane),E.call(y.plane);var K=y.plane.box(z),W="url(#"+z.select(".d2b-clip-plane").attr("id")+")";if(G.attr("clip-path",_?W:""),Y.each(function(t){var r="x2"===t.xType?Q.__axis__:N.__axis__,a="y2"===t.yType?I.__axis__:j.__axis__;e&&(this.genUpdate=this.genUpdate.transition(e),this.genExit=this.genExit.transition(e).style("opacity",0)),this.genExit.remove(),this.gen.each(function(t){var o=n.select(this);e&&(o=o.transition(e)),t.generator.x(r.scale()).y(a.scale()),o.style("opacity",1).call(t.generator)}),n.select(this).on("change",function(){return o.transition().duration(w).call(g)})}),L.style("opacity",0).remove(),R.attr("transform","translate("+K.left+", "+K.top+")").select("rect.d2b-axis-background").attr("height",Math.max(0,K.height)).attr("width",Math.max(0,K.width)),C.attr("transform","translate("+K.left+", "+K.top+")").select("rect.d2b-axis-background").attr("height",Math.max(0,K.height)).attr("width",Math.max(0,K.width)),y.annotation){var D={x:N.__scale__,y:j.__scale__,x2:Q.__scale__,y2:I.__scale__};B.call(at,y.annotation,A.filter(function(t){return"back"===t.z}),D),X.call(at,y.annotation,A.filter(function(t){return"front"===t.z}),D)}M.row(function(t){return s(t.graph.data,k).label+": "+i(t.y,t.y1,t.median)}),y.tooltipConfig(M),M.svgContainer(G).tracker(G).size(K)}function r(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a(t),e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l(n),r=e.filter(function(t){return!t.group});return r.forEach(function(t){t.groupType="graph",t.groupGraphs=[t]}),(y.groups(t)||[]).map(function(t){var n={groupType:"group",data:t,label:y.groupLabel(t),color:y.groupColor(t)};return n.groupGraphs=e.filter(function(t){return n.label===t.group}),n.groupGraphs.forEach(function(t){t.color=n.color}),n}).concat(r)}function a(t){return y.sets(t).map(function(t,n){var e={};return{data:t,key:y.setKey(t,n),xType:y.setXType(t)||"x",yType:y.setYType(t)||"y",generators:y.setGenerators(t).map(function(t,n){var r=t.type();return 0!==n&&(t.pannotation||t.pannotations||function(){})(null),t.annotation(y.annotation).key(y.graphKey),e[r]=e[r]||0,{data:t,key:r+"-"+(e[r]+=1),generator:t}}),graphs:o(t)}})}function o(t){return y.setGraphs(t).map(function(t,n){return{data:t,label:y.graphLabel(t)||"",key:y.graphKey(t,n),color:y.graphColor(t),group:y.graphGroup(t),annotations:y.graphAnnotations(t)||[],tooltipConfig:y.graphTooltipConfig(t)||function(){}}})}function l(t){return[].concat.apply([],t.map(function(t){return t.graphs}))}function c(t){t.forEach(function(t){t.groupGraphs.forEach(function(n){return n.data.hidden=t.data.hidden})})}function d(t,n){var e=n.selectAll(".d2b-graph"),r=n.selectAll(".d2b-axis-annotation");t.groupGraphs.some(function(t){return!t.data.hidden})&&(e.style("opacity",.2).filter(function(n){return t.data===n.data||(t.groupGraphs.map(function(t){return t.data})||[]).indexOf(n.data)>-1}).style("opacity",""),r.style("opacity",.2).filter(function(n){return t.data===n.graph||(t.groupGraphs.map(function(t){return t.data})||[]).indexOf(n.graph)>-1}).style("opacity",""))}function u(t,n){n.selectAll(".d2b-graph").style("opacity",1),n.selectAll(".d2b-axis-annotation").style("opacity",1)}function s(t,n){return n.filter(function(n){return n.data===t||n.data===t.data})[0]}function p(t,n,e){n.length||(t.hidden=!0);var r=t.axis||e.axis,a=t.scale?t.scale.copy():b(n,e),o=a.domain();if(!a.bandwidth&&t.linearPadding){var i=o[1]-o[0];o[0]=o[0]+i*t.linearPadding[0],o[1]=o[1]+i*t.linearPadding[1]}a.domain(o),t.__axis__=r.scale(a),t.__scale__=a}function b(t,e){var r=t.some(function(t){return isNaN(t)}),a=r?n.set(t).values():n.extent(t).map(function(t){return t||0});return(r?e.band:e.linear).domain(a)}var y={},g=function n(e){e.call(y.chartFrame),y.legend.empty(function(t){return t.data.hidden}).setEmpty(function(t,n,e){return t.data.hidden=e}).html(function(t){return t.label}).key(function(t){return t.label}).color(function(t){return t.color});var r=e.selection?e.selection():e;return r.each(function(n){t.call(this,n,e!==r?e:null)}),r.dispatch("chart-axis-updated",{bubbles:!0}),n};f(g,y).addProp("plane",j()).addProp("annotation",e.annotation?e.annotation():null).addProp("chartFrame",m().legendEnabled(!0).breadcrumbsEnabled(!1)).addProp("legend",x().clickable(!0).dblclickable(!0)).addPropFunctor("tooltipConfig",function(t){return t.tooltipConfig}).addPropFunctor("duration",250).addPropFunctor("x",{}).addPropFunctor("y",{}).addPropFunctor("x2",{}).addPropFunctor("y2",{}).addPropFunctor("clipPlane",!0).addPropFunctor("annotations",function(t){return t.annotations}).addPropFunctor("groups",function(t){return t.groups}).addPropFunctor("sets",function(t){return t.sets}).addPropFunctor("groupLabel",function(t){return t.label}).addPropFunctor("groupColor",function(t){return U(y.groupLabel(t))}).addPropFunctor("setKey",function(t,n){return n}).addPropFunctor("setGenerators",function(t){return t.generators}).addPropFunctor("setXType",function(t){return t.xType}).addPropFunctor("setYType",function(t){return t.yType}).addPropFunctor("setGraphs",function(t){return t.graphs}).addPropFunctor("graphKey",function(t){return t.label}).addPropFunctor("graphLabel",function(t){return t.label}).addPropFunctor("graphGroup",function(t){return t.group}).addPropFunctor("graphColor",function(t){return U(y.graphLabel(t))}).addPropFunctor("graphTooltipConfig",function(t){return t.tooltipConfig}).addPropFunctor("graphAnnotations",function(t){return t.annotations}).addPropFunctor("annotationKey",function(t,n){return n}).addPropFunctor("annotationXType",function(t){return t.xType}).addPropFunctor("annotationYType",function(t){return t.yType}).addPropFunctor("annotationZ",function(t){return t.z}).addPropFunctor("annotationX",function(t){return t.x}).addPropFunctor("annotationY",function(t){return t.y}).addPropFunctor("annotationX2",function(t){return t.x2}).addPropFunctor("annotationY2",function(t){return t.y2}).addPropFunctor("annotationColor",function(t){return t.color});var v=n.scaleBand(),k=n.scaleLinear(),P={x:{band:v.copy(),linear:k.copy(),axis:n.axisBottom()},y:{band:v.copy(),linear:k.copy(),axis:n.axisLeft()},x2:{band:v.copy(),linear:k.copy(),axis:n.axisTop()},y2:{band:v.copy(),linear:k.copy(),axis:n.axisRight()}};return g}function K(){function t(t,n){t.select(".d2b-breadcrumbs-container").datum(n).transition("sunburst-breadcrumbs").duration(100).call(a.breadcrumbs)}function e(n){var r=n.select(".d2b-sunburst-chart"),o=n.selectAll(".d2b-sunburst-arc.d2b-sunburst-level-0").datum(),i=o.selected;t(n,[i]),r.selectAll(".d2b-sunburst-arc").call(a.tooltip.clear).call(a.tooltip).on("mouseover.breadcrumbs",function(e){var r=e.ancestors();r=r.slice(0,r.indexOf(i)+1),t(n,r.reverse())}).on("mouseout.breadcrumbs",function(){return t(n,[i])}),r.on("mouseout",function(){return e(n)}).on("click",function(){return e(n)})}function r(t,r){var o=n.select(this),i=o.select(".d2b-chart-container"),l=i.node().__size__,c="translate("+l.width/2+", "+l.height/2+")",d=i.selectAll(".d2b-sunburst-chart").data(function(t){return[t]}),u=d.enter().append("g").attr("transform",c).attr("class","d2b-sunburst-chart");d=d.merge(u),r&&(d=d.transition(r)),a.sunburst.outerRadius(a.outerRadius(t,l.width,l.height)).innerRadius(a.innerRadius(t,l.width,l.height)),d.attr("transform",c).call(a.sunburst),e(o)}var a={},o=function t(n){n.call(a.chartFrame),a.sunburst.label(a.label).color(a.color),a.breadcrumbs.color(function(t){return a.color(t.data)}).key(function(t,n){return n}),a.tooltip.color(function(t){return a.color(t.data)});var e=n.selection?n.selection():n;return e.each(function(t){r.call(this,t,n!==e?n:null)}),e.dispatch("chart-sunburst-updated",{bubbles:!0}),t};f(o,a).addProp("chartFrame",m().legendEnabled(!1).breadcrumbsEnabled(!0)).addProp("sunburst",S()).addProp("breadcrumbs",g().html(function(t){return"<div class = 'd2b-sunburst-breadcrumb'>"+c(t)+"</div>"})).addProp("tooltip",b().followMouse(!0).html(function(t){return"<div class = 'd2b-sunburst-tooltip'>"+c(t)+"</div>"})).addPropFunctor("label",function(t){return t.label}).addPropFunctor("color",function(t){return U(a.label(t))}).addPropFunctor("outerRadius",function(t,n,e){return Math.min(n,e)/2}).addPropFunctor("innerRadius",function(t,n,e){return Math.min(50,Math.min(n,e)/4)});var i=n.format(",.0f"),l=n.format(".1%"),c=function(t){
var n=t.value/t.selected.value,e=n>1?"":"<div class = 'd2b-sunburst-percent'>\n        "+l(t.value/t.selected.value)+"\n      </div>";return"\n      <div class = 'd2b-sunburst-label'>\n        "+a.label(t.data)+"\n      </div>\n      <div class = 'd2b-sunburst-value'>\n        "+i(t.value)+"\n        "+e+"\n      </div>\n    "};return o}function W(){function t(n){n.call(r.chartFrame);var a=n.selection?n.selection():n;return a.each(function(t){e.call(this,t,n!==a?n:null)}),a.dispatch("chart-sankey-updated",{bubbles:!0}),t}function e(e,a){var o=n.select(this),i=o.select(".d2b-chart-container"),l=i.node().__size__,c=i.selectAll(".d2b-sankey-chart").data(function(t){return[t]}),d=c.enter().append("g").attr("class","d2b-sankey-chart");return c=c.merge(d),a&&(c=c.transition(a)),c.call(r.sankey.size(l)),c.selectAll(".d2b-sankey-link").call(r.linkTooltip),c.selectAll(".d2b-sankey-node").call(r.nodeTooltip),t}var r={},a=b().html(function(t){return"\n          <b>"+t.key+"</b>:\n          "+t.value+"\n        "}).color(function(t){return t.color}).followMouse(!0),o=b().html(function(t){return"\n          <b>"+t.source.key+"</b>\n          <i class='fa fa-arrow-right d2b-sankey-link-arrow' aria-hidden='true'></i>\n          <b>"+t.target.key+"</b>:\n          "+t.value+"\n        "}).color("#444").followMouse(!0);return f(t,r).addProp("chartFrame",m().legendEnabled(!1).breadcrumbsEnabled(!1)).addProp("sankey",N()).addProp("nodeTooltip",a).addProp("linkTooltip",o),t}!function(t,n){if("undefined"==typeof document)return n;t=t||"";var e=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",e.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}('.d2b-draggable{cursor:move}.d2b-vue-container{width:100%;height:100%}.d2b-pie-chart .d2b-pie-arc path{stroke-width:1px;stroke:#fff}.d2b-pie-chart .d2b-pie-arc text{fill:#fff;font-weight:700;pointer-events:none;text-anchor:middle}.d2b-axis-wrapper .d2b-axis-background{opacity:0}.d2b-chart-breadcrumbs{width:200px;padding-left:10px}.d2b-sunburst-breadcrumb .d2b-sunburst-label,.d2b-sunburst-tooltip .d2b-sunburst-label{text-align:center}.d2b-sunburst-breadcrumb .d2b-sunburst-value,.d2b-sunburst-tooltip .d2b-sunburst-value{font-size:14pt;margin-top:5px}.d2b-sunburst-breadcrumb .d2b-sunburst-percent{float:right}.d2b-breadcrumbs:not(.d2b-vertical) .d2b-sunburst-percent{margin-left:30px}.d2b-sunburst-tooltip{text-align:center}.d2b-sunburst-tooltip .d2b-sunburst-percent{display:inline}.d2b-sunburst-tooltip .d2b-sunburst-percent:before{content:"("}.d2b-sunburst-tooltip .d2b-sunburst-percent:after{content:")"}.d2b-sankey-link-arrow{font-size:10px;position:relative;top:-2px}.d2b-line-graph .d2b-line{stroke-width:1.5px;fill:none}.d2b-area-graph .d2b-area{stroke:none;fill-opacity:0.3}.d2b-box .d2b-box-center,.d2b-box .d2b-box-dash,.d2b-box .d2b-box-outlier,.d2b-box .d2b-box-rect{stroke-width:1.5px}.d2b-box .d2b-box-rect{fill:#fff}.d2b-box .d2b-box-center{stroke-dasharray:3 3}.d2b-box .d2b-box-label{fill:#555;font-size:10pt}.d2b-box .d2b-box-outlier{fill:none;stroke-opacity:0.4}\n/*.d2b-box-graph {\n  .d2b-box-dash,\n  .d2b-box-center,\n  .d2b-box-rect,\n  .d2b-box-outlier {\n    stroke-width: 1.5px;\n  }\n\n  .d2b-box-rect {\n    fill: #fff;\n  }\n\n  .d2b-box-center {\n    stroke-dasharray: 3 3;\n  }\n\n  .d2b-box-label {\n    fill: #555;\n    font-size: 10pt;\n    dominant-baseline: middle;\n  }\n\n  .d2b-box-outlier {\n    fill: none;\n    stroke: #888;\n    opacity: 0.4;\n  }\n}*/.d2b-bar-graph .d2b-bar-group rect{opacity:0.8}.d2b-bubble-pack-graph .d2b-bubble-point{opacity:0.75}.d2b-bubble-pack-graph .d2b-bubble-indicator rect{fill-opacity:0.25;stroke-opacity:0.9;cursor:pointer;stroke-width:1px}.d2b-bubble-pack-graph .d2b-bubble-indicator rect:hover{stroke-width:2px}.d2b-bubble-pack-graph .d2b-bubble-indicator path,.d2b-bubble-pack-graph .d2b-bubble-indicator text{pointer-events:none}.d2b-plane text{font-size:10pt}.d2b-plane .d2b-y2-axis .d2b-axis-label,.d2b-plane .d2b-y-axis .d2b-axis-label{-webkit-transform:rotate(-90deg);transform:rotate(-90deg)}.d2b-plane .d2b-y2-axis .tick line,.d2b-plane .d2b-y-axis .tick line{stroke-width:0.6px}.d2b-plane .d2b-grid .tick line{shape-rendering:crispEdges;stroke-width:0.5px;stroke-opacity:0.15}.d2b-plane .d2b-grid .tick text{display:none}.d2b-plane .d2b-axis-label{fill:#000;font-weight:700}.d2b-plane path.domain{stroke-width:0.4px;stroke-opacity:0.4}.d2b-sunburst-arc{transition:opacity 0.2s,stroke-width 0.2s;cursor:pointer;opacity:0.9;stroke-width:0.8px;stroke:#fff}.d2b-sunburst-arc.d2b-transparent{fill-opacity:0.2}.d2b-sunburst-label{font-size:8pt;fill-opacity:0.8;pointer-events:none;font-family:arial}.d2b-sunburst-label.d2b-transparent{fill-opacity:0.2}.d2b-sunburst-center{fill-opacity:0;stroke:none;cursor:pointer}.d2b-sunburst-ancestor{opacity:0.4}.d2b-sankey-links path{fill:none}.d2b-sankey-links path,.d2b-sankey-links rect{opacity:0.4}.d2b-sankey-links path:hover,.d2b-sankey-links rect:hover{opacity:0.6}.d2b-sankey-nodes rect{stroke-width:0.3px;stroke:#000;opacity:0.6}.d2b-sankey-nodes rect:hover{opacity:0.8}.d2b-text-anchor-end{text-anchor:end}\n/*.d2b-tooltip-area {\n  pointer-events: none;*/.d2b-tooltip{pointer-events:none;background:#fff;border:1px solid #bbb;border-radius:2px;position:fixed;box-shadow:0px 0px 2px #ccc;margin:0}.d2b-tooltip:before{left:0;top:0;position:absolute;z-index:2;content:""}.d2b-tooltip-content{white-space:nowrap;padding:6px 10px}.d2b-tooltip-top{-webkit-transform:translate(-50%,-100%);transform:translate(-50%,-100%);margin-left:0;margin-top:-15px}.d2b-tooltip-top:before{-webkit-transform:translateX(-50%);transform:translateX(-50%);left:50%;top:100%;width:0;height:0;border-style:solid;border-color:transparent;border-width:6px 6px 0;border-top-color:inherit}.d2b-tooltip-bottom{-webkit-transform:translate(-50%,0);transform:translate(-50%,0);margin-left:0;margin-top:15px}.d2b-tooltip-bottom:before{-webkit-transform:translateX(-50%);transform:translateX(-50%);left:50%;top:-6px;width:0;height:0;border-style:solid;border-color:transparent;border-width:0 6px 6px;border-bottom-color:inherit}.d2b-tooltip-right{-webkit-transform:translate(0,-50%);transform:translate(0,-50%);margin-left:15px;margin-top:0}.d2b-tooltip-right:before{-webkit-transform:translateY(-50%);transform:translateY(-50%);left:-6px;top:50%;width:0;height:0;border-style:solid;border-color:transparent;border-width:6px 6px 6px 0;border-right-color:inherit}.d2b-tooltip-left{-webkit-transform:translate(-100%,-50%);transform:translate(-100%,-50%);margin-left:-15px;margin-top:0}.d2b-tooltip-left:before{-webkit-transform:translateY(-50%);transform:translateY(-50%);left:100%;top:50%;width:0;height:0;border-style:solid;border-color:transparent;border-width:6px 0 6px 6px;border-left-color:inherit}\n/*}*/\n/*.d2b-tooltip-axis-area {\n  pointer-events: none;\n  font-family: \'Arial\';*/.d2b-tooltip-marker{stroke-width:2px;stroke:#bbb;stroke-dasharray:5,5}.d2b-tooltip-axis{pointer-events:none;font-family:Arial;opacity:0.9;white-space:nowrap;border:1px solid #ddd;background:hsla(0,0%,100%,.8);position:absolute;box-shadow:0px 0px 2px #ccc}.d2b-tooltip-axis .d2b-tooltip-title{text-align:center;background:rgba(150,165,175,.8);padding:5px 10px;font-weight:700;color:#fff}.d2b-tooltip-axis .d2b-tooltip-content{padding:5px 10px}.d2b-tooltip-axis .d2b-tooltip-content .d2b-tooltip-row{padding-left:5px;border-left-width:3px;border-left-style:solid;margin-bottom:5px}.d2b-tooltip-axis .d2b-tooltip-content .d2b-tooltip-row:last-child{margin-bottom:0px}\n/*}*/.d2b-breadcrumbs{color:#555;font-size:9pt;box-sizing:content-box}.d2b-breadcrumbs .d2b-breadcrumb{border:0px solid transparent;border-left-width:8px;border-bottom-width:1px;padding:6px 13px;margin-bottom:10px;text-transform:uppercase;position:relative}.d2b-breadcrumbs .d2b-breadcrumb:first-child .d2b-breadcrumb-icon:after,.d2b-breadcrumbs .d2b-breadcrumb:last-child .d2b-breadcrumb-icon:after{position:absolute;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);left:-15.5px;width:13px;height:13px;text-align:center;font-family:FontAwesome;color:#fff;background-color:inherit;padding:5px;border-radius:15px}.d2b-breadcrumbs .d2b-breadcrumb:first-child .d2b-breadcrumb-icon:after{content:"\\f015"}.d2b-breadcrumbs .d2b-breadcrumb:not(:first-child):last-child .d2b-breadcrumb-icon:after{content:"\\f25a"}.d2b-breadcrumbs:not(.d2b-vertical){white-space:nowrap}.d2b-breadcrumbs:not(.d2b-vertical) .d2b-breadcrumb{border-right-width:1px;border-top-width:1px;white-space:nowrap;display:inline-block}.d2b-breadcrumbs:not(.d2b-vertical) .d2b-breadcrumb:not(:last-child){margin-right:20px}.d2b-breadcrumbs:not(.d2b-vertical) .d2b-breadcrumb:not(:last-child):after{width:0;height:0;border-style:solid;border-color:transparent;border-width:6px 0 6px 6px;border-left-color:inherit;position:absolute;z-index:2;content:"";top:50%;left:100%;-webkit-transform:translateY(-50%);transform:translateY(-50%)}.d2b-breadcrumbs.d2b-vertical .d2b-breadcrumb{/*&:after {\n      triangle: pointing-right;\n      width: 100px;\n      height: 100px;\n      background-color: inherit;\n      position: absolute;\n      z-index: 2;\n      content: \'\';\n\n      top: 100%;\n      left: 50%;\n\n      transform: translateX(-50%);\n\n    }*/}.d2b-breadcrumbs.d2b-vertical .d2b-breadcrumb:not(:last-child):after{width:0;height:0;border-style:solid;border-color:transparent;border-width:6px 6px 0;border-top-color:inherit;position:absolute;z-index:2;content:"";top:100%;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%)}.stuff{display:none}.d2b-legend{color:#555;font-size:9pt}.d2b-legend .d2b-legend-item{border:0px solid transparent;padding:2px;padding-left:18px;position:relative;cursor:pointer}.d2b-legend .d2b-legend-item .d2b-legend-icon{position:absolute;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);left:7px;width:12px;height:12px}.d2b-legend .d2b-legend-item .d2b-legend-svg-icon{margin-left:-5px;margin-top:-5px;pointer-events:none}.d2b-legend .d2b-legend-item .d2b-legend-svg-icon path,.d2b-legend .d2b-legend-item .d2b-legend-svg-icon text{font-family:FontAwesome;text-anchor:middle;stroke-width:1px;fill-opacity:0.8}.d2b-legend:not(.d2b-vertical) .d2b-legend-item{display:inline-block}.d2b-legend:not(.d2b-vertical) .d2b-legend-item:not(:last-child){margin-right:10px}.d2b-legend:not(.d2b-vertical) .d2b-legend-icon{margin-top:1.5px}.d2b-chart-frame{height:100%;width:100%;position:relative}.d2b-chart-frame .d2b-breadcrumbs-frame,.d2b-chart-frame .d2b-chart,.d2b-chart-frame .d2b-legend-frame{position:absolute;overflow:auto}.d2b-chart-frame .d2b-breadcrumbs-frame .d2b-breadcrumbs,.d2b-chart-frame .d2b-legend-frame .d2b-breadcrumbs{padding-left:10px;padding-right:2px}.d2b-chart-frame .d2b-breadcrumbs-frame:not(.d2b-vertical),.d2b-chart-frame .d2b-legend-frame:not(.d2b-vertical){overflow-y:hidden}.d2b-chart-frame .d2b-breadcrumbs-frame:not(.d2b-vertical) .d2b-breadcrumbs,.d2b-chart-frame .d2b-breadcrumbs-frame:not(.d2b-vertical) .d2b-legend,.d2b-chart-frame .d2b-breadcrumbs-frame:not(.d2b-vertical) .d2b-legend-item,.d2b-chart-frame .d2b-legend-frame:not(.d2b-vertical) .d2b-breadcrumbs,.d2b-chart-frame .d2b-legend-frame:not(.d2b-vertical) .d2b-legend,.d2b-chart-frame .d2b-legend-frame:not(.d2b-vertical) .d2b-legend-item{white-space:nowrap;overflow-y:hidden}.d2b-chart-frame .d2b-breadcrumbs-frame:not(.d2b-vertical).d2b-legend-frame,.d2b-chart-frame .d2b-legend-frame:not(.d2b-vertical).d2b-legend-frame{height:20px;text-align:center}.d2b-chart-frame .d2b-breadcrumbs-frame:not(.d2b-vertical).d2b-breadcrumbs-frame,.d2b-chart-frame .d2b-legend-frame:not(.d2b-vertical).d2b-breadcrumbs-frame{height:55px}.d2b-chart-frame .d2b-breadcrumbs-frame.d2b-vertical .d2b-breadcrumbs-container,.d2b-chart-frame .d2b-breadcrumbs-frame.d2b-vertical .d2b-legend-container,.d2b-chart-frame .d2b-legend-frame.d2b-vertical .d2b-breadcrumbs-container,.d2b-chart-frame .d2b-legend-frame.d2b-vertical .d2b-legend-container{display:table;height:100%;width:100%}.d2b-chart-frame .d2b-breadcrumbs-frame.d2b-vertical .d2b-breadcrumbs-container .d2b-legend,.d2b-chart-frame .d2b-breadcrumbs-frame.d2b-vertical .d2b-legend-container .d2b-legend,.d2b-chart-frame .d2b-legend-frame.d2b-vertical .d2b-breadcrumbs-container .d2b-legend,.d2b-chart-frame .d2b-legend-frame.d2b-vertical .d2b-legend-container .d2b-legend{display:table-cell;vertical-align:middle}.d2b-chart-frame .d2b-breadcrumbs-frame.d2b-vertical .d2b-breadcrumbs-container .d2b-breadcrumbs,.d2b-chart-frame .d2b-breadcrumbs-frame.d2b-vertical .d2b-legend-container .d2b-breadcrumbs,.d2b-chart-frame .d2b-legend-frame.d2b-vertical .d2b-breadcrumbs-container .d2b-breadcrumbs,.d2b-chart-frame .d2b-legend-frame.d2b-vertical .d2b-legend-container .d2b-breadcrumbs{display:table-cell;vertical-align:top}.d2b-chart-frame .d2b-breadcrumbs-frame.d2b-vertical.d2b-breadcrumbs-frame,.d2b-chart-frame .d2b-legend-frame.d2b-vertical.d2b-breadcrumbs-frame{width:180px}.d2b-chart-frame .d2b-breadcrumbs-frame.d2b-vertical.d2b-legend-frame,.d2b-chart-frame .d2b-legend-frame.d2b-vertical.d2b-legend-frame{width:110px}',void 0);var D=function(){return"ontouchstart"in window||window.navigator.msPointerEnabled},U=n.scaleOrdinal(n.schemeCategory10),V=function(){return Math.random().toString(36).substr(2,9)},q=function(t){return null===t?NaN:+t};k.tendancy="mean",P.tendancy="median",w.tendancy="mode",F.tendancy="range",_.tendancy="midpoint";var Z=Math.PI,H=Math.sqrt(8),J=Math.sqrt(2),$={draw:function(t,n){var e=Math.sqrt(n/(Z+5/4)),r=.3125*e,a=2*Math.asin(.25),o=(Z/2-a)/2,i=e/H-e*Math.cos(o),l=e*Math.sin(o);t.arc(i,l,e,-o,2*Z-a-o),t.lineTo(e*(5/4-1/J),-e*(1/H+5/4-1/J)),t.lineTo(e*(5/4-1/J)-r,-e*(1/H+5/4-1/J)),t.lineTo(e*(5/4-1/J)-r,-e*(1/H+7/4-1/J)),t.lineTo(e*(7/4-1/J+1/H),-e*(1/H+7/4-1/J)),t.lineTo(e*(7/4-1/J+1/H),-e*(5/4-1/J)+r),t.lineTo(e*(5/4-1/J+1/H),-e*(5/4-1/J)+r),t.lineTo(e*(5/4-1/J+1/H),-e*(5/4-1/J)),t.closePath()}},tt={draw:function(t,n){var e=Math.sqrt(n/(Z+5/4)),r=2*Math.asin(.25),a=e/4-e*Math.cos(r/2);t.arc(0,a,e,3*-Z/2+r/2,Z/2-r/2),t.lineTo(e/4,3*e/4),t.lineTo(3*e/4,3*e/4),t.lineTo(3*e/4,5*e/4),t.lineTo(e/4,5*e/4),t.lineTo(e/4,7*e/4),t.lineTo(-e/4,7*e/4),t.lineTo(-e/4,5*e/4),t.lineTo(3*-e/4,5*e/4),t.lineTo(3*-e/4,3*e/4),t.lineTo(-e/4,3*e/4),t.closePath()}},nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},et=(function(){function t(t){this.value=t}function n(n){function e(t,n){return new Promise(function(e,a){var l={key:t,arg:n,resolve:e,reject:a,next:null};i?i=i.next=l:(o=i=l,r(t,n))})}function r(e,o){try{var i=n[e](o),l=i.value;l instanceof t?Promise.resolve(l.value).then(function(t){r("next",t)},function(t){r("throw",t)}):a(i.done?"return":"normal",i.value)}catch(t){a("throw",t)}}function a(t,n){switch(t){case"return":o.resolve({value:n,done:!0});break;case"throw":o.reject(n);break;default:o.resolve({value:n,done:!1})}o=o.next,o?r(o.key,o.arg):i=null}var o,i;this._invoke=e,"function"!=typeof n.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(n.prototype[Symbol.asyncIterator]=function(){return this}),n.prototype.next=function(t){return this._invoke("next",t)},n.prototype.throw=function(t){return this._invoke("throw",t)},n.prototype.return=function(t){return this._invoke("return",t)}}(),function(t){return e.annotation().disable(t.disable()).textWrap(t.textWrap()).notePadding(t.notePadding()).type(t.type()).accessors(t.accessors()).accessorsInverse(t.accessorsInverse()).ids(t.ids()).editMode(t.editMode()).collection(t.collection())}),rt=function(t,e,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(t){return t.annotation?[t.annotation]:[]},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(t){return t.color},l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"translate(0, 0)",c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"translate(0, 0)",d=t.selection?t.selection():t;t.each(function(u){var s=n.select(this),p=o(a)(u),f=s.selectAll("g."+r).data(p),b=f.enter().append("g"),h=f.merge(b),y=f.exit();b.attr("class",r).attr("transform",function(t){return o(c)(u,t)}).style("opacity",0),p.forEach(function(t){t.x=0,t.y=0,t.color=o(i)(u,t)}),p.length&&e&&(h.selectAll("*").remove(),h.call(et(e).annotations(p))),t!==d&&(h=h.transition(t),y=y.transition(t)),h.attr("transform",function(t){return o(l)(u,t)}).style("opacity",1),y.attr("transform",function(t){return o(l)(u,t)}).style("opacity",0).remove()})},at=function(t,e,r,a){var o=t.selection?t.selection():t,i=o.node(),l=i.__scales||a,c=function(t,n){var e=n[t.xType],r=n[t.yType],a=t.x===1/0?e.range()[0]:e(t.x),o=t.y===1/0?r.range()[0]:r(t.y),i=t.x2===1/0?e.range()[1]:e(t.x2),l=t.y2===1/0?r.range()[1]:r(t.y2);return"translate("+[isNaN(i)?a:Math.min(a,i),isNaN(l)?o:Math.min(o,l)]+")"},d=function(t,n){var e=G(t.data.subject)||{},r=n[t.xType],a=n[t.yType],o=t.x===1/0?r.range()[0]:r(t.x),i=t.y===1/0?a.range()[0]:a(t.y),l=t.x2===1/0?r.range()[1]:r(t.x2),c=t.y2===1/0?a.range()[1]:a(t.y2),d=t.x2?Math.abs(o-l):0,u=t.y2?Math.abs(i-c):0;return t.x2&&t.y2?(e.width=d,e.height=u):t.x2?(e.x1=0,e.x2=d):t.y2&&(e.y1=0,e.y2=u),e.dx=e.dx*d,e.dy=e.dy*u,e};i.__scales={x:a.x.copy(),y:a.y.copy(),x2:a.x2.copy(),y2:a.y2.copy()};var u=o.selectAll(".d2b-axis-annotation").data(r,function(t){return t.key}),s=u.enter().append("g"),p=u.exit();u.selectAll("*").remove(),u=u.merge(s),s.attr("class","d2b-axis-annotation").attr("transform",function(t){return c(t,l)}).style("opacity",0),t!==o&&(u=u.transition(t),p=p.transition(t)),u.attr("transform",function(t){return c(t,a)}).style("opacity",1),p.attr("transform",function(t){return c(t,a)}).style("opacity",0).remove(),u.each(function(r){var i=G(r.data),l=n.select(this),c=et(e);i.x=0,i.y=0,i.color=r.color,i.subject=d(r,a),i.dx=(i.subject.dx||0)+(r.data.dx||0),i.dy=(i.subject.dy||0)+(r.data.dy||0),t!==o?l.transition(t).tween("annotation-tween",function(){var t=this,e=n.interpolateObject(this.__subject||d(r,a),i.subject);return function(n){t.__subject=i.subject=e(n),i.dx=(i.subject.dx||0)+(r.data.dx||0),i.dy=(i.subject.dy||0)+(r.data.dy||0),l.call(c.annotations([i]))}}):l.call(c.annotations([i]))})};t.version="0.0.41",t.textWrap=l,t.textWrapPX=c,t.tweenArc=d,t.tweenNumber=s,t.tweenCentroid=p,t.tooltip=b,t.tooltipAxis=h,t.stack=y,t.breadcrumbs=g,t.legend=x,t.chartFrame=m,t.defaultColor=U,t.id=V,t.color=U,t.omit=v,t.mean=k,t.median=P,t.mode=w,t.range=F,t.midpoint=_,t.toDegrees=A,t.toRadians=M,t.modelBase=f,t.symbolMars=$,t.symbolVenus=tt,t.point=z,t.svgPie=E,t.svgLine=C,t.svgArea=R,t.svgScatter=B,t.svgBar=X,t.svgBoxPlot=O,t.svgBubblePack=L,t.svgSunburst=S,t.svgSankey=N,t.plane=j,t.box=Y,t.chartPie=Q,t.chartAxis=I,t.chartSunburst=K,t.chartSankey=W}(this.d2b=this.d2b||{},d3,d3,d3,d3);